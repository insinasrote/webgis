// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dojo/dom-geometry dojo/dom-class dojo/Evented dojo/debounce".split(" "),function(n,f,h,l,d,a,b,c){return n([l,b],{baseClass:"jimu-dijit-gridlayout",declaredClass:"jimu.dijit.GridLayout",container:null,layoutDefinition:null,components:null,editable:!1,_layout:null,_coordinates:null,_isCreatingLayout:null,postCreate:function(){this.inherited(arguments);this._isCreatingLayout=
!1;this._createLayout(this.layoutDefinition)},restoreLayout:function(a){a=a||this.layoutDefinition;this._createLayout(a)},destroy:function(){h.forEach(this.components,function(a){a.dijit.destroy()});this._layout.destroy();this.inherited(arguments)},getLayoutDefinition:function(){return this._layout.toConfig().content},resize:function(){var a=d.getMarginBox(this.container);this._layout.updateSize(a.w,a.h)},getComponentSize:function(a){return(a=this._layout.root.contentItems[0].getItemsById(a))&&0<
a.length?(a=a[0].container,{w:a.width,h:a.height}):{w:0,h:0}},getSize:function(){return{w:this._layout.width,h:this._layout.height}},setVisible:function(a,b){var e=this._layout.root.contentItems[0].getItemsById(a);e&&0<e.length&&!1===b?this._hideComponent(e[0]):e&&0!==e.length||!0!==b||this._showComponent(a)},_createLayout:function(b){if(!this._isCreatingLayout){this._coordinates={};this._isCreatingLayout=!0;var g={settings:{hasHeaders:!1,resizeEnabled:this.editable,reorderEnabled:this.editable,selectionEnabled:this.editable},
dimensions:{borderWidth:1,dragProxyWidth:0,dragProxyHeight:0},content:b},e=this._layout;require(["libs/goldenlayout/goldenlayout"],f.hitch(this,function(k){this._layout=new k(g,this.container);this._layout.registerComponent("jimu grid",f.hitch(this,function(a,k){var e;a.parent.config.id=k.id;h.some(this.components,function(b){if(b.id===k.id)return e=b.dijit,a.getElement().html(b.dijit.domNode),!0},this);a.on("resize",c(f.hitch(this,function(){0<a.width&&0<a.height&&e&&"function"===typeof e.resize&&
e.resize(a.width,a.height)}),200));a.on("select",f.hitch(this,function(){this.editable&&a.parent.select();this.emit("mask-click",a.parent.config.id)}))}));this._layout.on("initialised",f.hitch(this,function(){this._resetCoordinate();this.emit("initialised");this._isCreatingLayout=!1;e&&e.destroy()}));this._layout.on("stateChanged",f.hitch(this,function(){this._resetCoordinate()}));this._layout.init();this.editable||a.add(this._layout.root.childElementContainer[0],"viewonly");a.add(this._layout.root.childElementContainer[0],
"jimu-dijit-gridlayout");setTimeout(f.hitch(this,this.resize),100)}))}},_hideComponent:function(a){a.parent&&a.parent.removeChild(a,!0)},_showComponent:function(a){var b,e,k,c,d,m,q;h.some(this.components,function(e){if(e.id===a)return b=e,!0},this);b&&(c={id:a,type:"component",componentName:"jimu grid",componentState:{id:a}},e=this._coordinates[a],d=this._layout.root,e?(e[0].type!==d.contentItems[0].type&&(m=d.contentItems[0],d.replaceChild(m,{type:e[0].type,content:[]}),d.contentItems[0].addChild(m)),
k=d,h.forEach(e,function(a){q=a.index<=k.contentItems.length?a.index:k.contentItems.length;"component"===a.type?k.addChild(c,q):("stack"!==a.type&&k.contentItems[a.index].type===a.type||k.addChild({type:a.type,content:[]},q),k=k.contentItems[q])},this)):("stack"===d.contentItems[0].type&&(m=d.contentItems[0],d.replaceChild(m,{type:"column",content:[]}),d.contentItems[0].addChild(m)),d.contentItems[0].addChild(c)))},_resetCoordinate:function(){var a=this._layout.root.getItemsByType("component"),b=
function(a,k){var e=a.parent;e&&(h.some(e.contentItems,function(e,b){if(e===a)return k.push({type:e.type,index:b}),!0}),b(e,k))};h.forEach(a,function(a){var e=[];b(a,e);this._coordinates[a.config.id]=e.reverse()},this)}})})},"widgets/Infographic/DijitFactory":function(){define("dojo/aspect dojo/_base/lang ./dijits/TextDijit ./dijits/ImageDijit ./dijits/ChartDijit ./dijits/GaugeDijit ./dijits/NumberDijit".split(" "),function(n,f,h,l,d,a,b){var c={},m={},g=null,e=null,k=null,p=null,t={};c._dijits=m;
c.createDijit=function(c){var q=null;if(m[c.id])return(q=m[c.id])&&"function"===typeof q.setVisible&&q.setVisible(c.visible),q;var r;switch(c.type){case "text":r=h;break;case "image":r=l;break;case "chart":r=d;break;case "gauge":r=a;break;case "number":r=b}if(!r)return console.error("Unknow type:",c.type),null;q={nls:g,config:c.config,map:e,inSettingPage:k,appConfig:p,jsonId:c.id,visible:c.visible};f.mixin(q,t);q=new r(q);n.after(q,"destroy",function(){delete m[c.id]});return m[c.id]=q};c.setNls=
function(a){g=a};c.setMap=function(a){e=a;Object.keys(m).forEach(function(a){m[a].setMap(e)})};c.setInSettingPage=function(a){k=a;Object.keys(m).forEach(function(a){m[a].setInSettingPage(k)})};c.setAppConfig=function(a){p=a;Object.keys(m).forEach(function(a){m[a].setAppConfig(p)})};c.setContext=function(a){t=a;Object.keys(m).forEach(function(a){f.mixin(m[a],t)})};return c})},"widgets/Infographic/dijits/TextDijit":function(){define(["dojo/_base/declare","dojo/_base/html","./BaseDijit","./styleUtils"],
function(n,f,h,l){return n([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",type:"text",config:null,postCreate:function(){this.setConfig(this.config)},setConfig:function(d){this.config=d;f.empty(this.domNode);f.addClass(this.domNode,"table-layout-container");f.addClass(this.domNode,"no-trim");this.innerDom=f.create("div",{},this.domNode);f.place(this.innerDom,this.domNode);d={};l.background.setStyle(this.config.background,d,this);l.font.setStyle(this.config.font,d);l.font.setText(this.config,this);f.setStyle(this.innerDom,
d)}})})},"widgets/Infographic/dijits/BaseDijit":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(n,f,h){return n([f,h],{templateString:"\x3cdiv\x3ePlease create a sub class\x3c/div\x3e",type:"BaseDijit",config:null,inSettingPage:!0,appConfig:null,constructor:function(f){this.config=f.config},setInSettingPage:function(f){this.inSettingPage=f},setConfig:function(f){this.config=f},setMap:function(f){this.map=f},setDataSource:function(f){this.dataSource=f},
resize:function(){},setAppConfig:function(f){this.appConfig=f},onDataSourceDataUpdate:function(f){this.data=f},isDarkTheme:function(){var f=!1;this.appConfig&&("DashboardTheme"!==this.appConfig.theme.name||"default"!==this.appConfig.theme.styles[0]&&"style3"!==this.appConfig.theme.styles[0]?"DartTheme"===this.appConfig.theme.name&&(f=!0):f=!0);return f}})})},"widgets/Infographic/dijits/styleUtils":function(){define(["dojo/on","dojo/_base/lang","jimu/utils"],function(n,f,h){var l={background:{setStyle:function(d,
a,b){if(!d)return{};a||(a={});l.background.setBackgroundColor(d,a);l.background.setAlignment(d,a);l.background.setLink(d,a,b)},setBackgroundColor:function(d,a){d.backgroundColor&&(a.backgroundColor=d.backgroundColor)},setAlignment:function(d,a){if(d.alignment){if(d.alignment.horizontal)switch(d.alignment.horizontal){case "left":a.textAlign="left";break;case "center":a.textAlign="center";break;case "right":a.textAlign="right";break;default:a.textAlign="center"}if(d.alignment.vertical)switch(a.display=
"table-cell",d.alignment.vertical){case "top":a.verticalAlign="top";break;case "middle":a.verticalAlign="middle";break;case "bottom":a.verticalAlign="bottom";break;default:a.verticalAlign="middle"}}},setLink:function(d,a,b){b.clickHanlder&&(b.clickHanlder[0]&&b.clickHanlder[0].remove(),b.clickHanlder=null,a.cursor="auto");d.link&&(b.clickHanlder=b.own(n(b.domNode,"click",f.hitch(b,function(){window.open(d.link)}))),a.cursor="pointer")}},font:{setText:function(d,a){var b="";d.text&&(b=d.text);a.innerDom.innerHTML=
b},setStyle:function(d,a){if(!d)return{};a||(a={});l.font.setFont(d,a);l.font.setTextColor(d,a);l.font.setFontSize(d,a)},setFont:function(d,a){a.fontWeight="normal";a.fontStyle="normal";a.textDecoration="none";d.font&&(d.font.fontFamily&&(a.fontFamily=d.font.fontFamily),d.font.bold&&(a.fontWeight="bold"),d.font.italic&&(a.fontStyle="italic"),d.font.underline&&(a.textDecoration="underline"))},setTextColor:function(d,a){d.textColor&&(a.color=d.textColor)},setFontSize:function(d,a){d.fontSize&&(a.fontSize=
d.fontSize+"px")}},image:{setStyle:function(d,a,b){if(!d)return{};a||(a={});l.image.setBackgroundImg(d,a,b);l.image.setAlignment(d,a)},setBackgroundImg:function(d,a,b){var c="";if(c=d&&!d.image&&b&&b.folderUrl?"url("+b.folderUrl+"/images/default_image.png)":"url("+h.processUrlInWidgetConfig(d.image,b.folderUrl)+")")a.backgroundImage=c,a.backgroundRepeat="no-repeat",a.backgroundSize="contain"},setAlignment:function(d,a){if(d&&d.background){var b="center",c="center";if(d.background.alignment){d.background.alignment.horizontal&&
(b=d.background.alignment.horizontal);if(d.background.alignment.vertical)switch(d.background.alignment.vertical){case "top":c="top";break;case "middle":c="center";break;case "bottom":c="bottom";break;default:a.verticalAlign="center"}a.backgroundPosition=b+" "+c}}}},dataFormat:{getText:function(d,a){var b="";d.dataFormat&&(b=a?a:d.text,b=l.dataFormat.setDataFomat(d,b),d.dataFormat.prefix&&(b=d.dataFormat.prefix+" "+b),d.dataFormat.suffix&&(b=b+" "+d.dataFormat.suffix));return b},setDataFomat:function(d,
a){var b=d.dataFormat.unit;"none"===d.dataFormat.unit?b="":"percentage"===d.dataFormat.unit&&(b="%");return a=a+b+"("+d.dataFormat.decimalPlaces+") "}}};return l})},"widgets/Infographic/dijits/ImageDijit":function(){define(["dojo/_base/declare","dojo/_base/html","./BaseDijit","./styleUtils"],function(n,f,h,l){return n([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",type:"image",config:null,constructor:function(d){this.config=d.config},postCreate:function(){this.setConfig(this.config)},setConfig:function(d){this.config=
d;this.domNode.innerHTML="";f.addClass(this.domNode,"table-layout-container");this.innerDom=f.create("div",{"class":"image-node"},this.domNode);f.place(this.innerDom,this.domNode);d={};l.background.setStyle(this.config.background,d,this);l.image.setStyle(this.config,d,this);f.setStyle(this.innerDom,d)}})})},"widgets/Infographic/dijits/ChartDijit":function(){define("dojo/_base/lang dojo/_base/html dojo/_base/declare ./BaseDijit dojo/text!./ChartDijit.html moment/moment jimu/dijit/_chartDijitOption jimu/dijit/Chart jimu/DataSourceManager jimu/LayerInfos/LayerInfos ../utils".split(" "),
function(n,f,h,l,d,a,b,c,m,g,e){window.makeTwix(a);return h([l],{templateString:d,type:"chart",baseClass:"infographic-chart-dijit",layerInfosObj:null,dataSourceManager:null,featuresCountForPreview:50,dataSource:null,config:null,map:null,maxTimeIntervals:1E4,maxLabels:1E4,dsType:"",constructor:function(a){this.visible=a.visible;this.config=this._classifyChartConfig(a.config);this.layerInfosObj=g.getInstanceSync();this.dataSourceManager=m.getInstance();this.popupInfo=this.layerObject=this.featureLayerForFrameWork=
null},postCreate:function(){this.inherited(arguments);this._init()},setLayerInfo:function(a,e,b){this.layerObject=a;this.popupInfo=b;this.featureLayerForFrameWork=e;this._initChartDijitOption()},getDataURL:function(){if(this.chart)return this.chart.getDataURL()},resize:function(){this.chart&&this.chart.resize()},setVisible:function(a){this.visible=a},destroy:function(){this.chart&&this.chart.destroy();this.chart=null;this.inherited(arguments)},clearChart:function(){this.chart&&this.chart.clear();
this.showNodata()},setBackgroundColor:function(a){this.domNode.style.backgroundColor=a},_setyAxisName:function(){var a=(this.config=this._classifyChartConfig(this.config))&&this.config.display;(a=a&&a.yAxis)&&a.show&&"undefined"!==typeof a.name?(this._showyAxisName(),this._setyAxisNameText(a.name),(a=a.nameTextStyle)&&a.color&&this._setyAxisNameColor(a.color)):this._hideyAxisName()},_setyAxisNameText:function(a){this.yAxisName.innerHTML=a},_setyAxisNameColor:function(a){f.setStyle(this.yAxisName,
"color",a)},_hideyAxisName:function(){f.setStyle(this.yAxisName,"display","none")},_showyAxisName:function(){f.setStyle(this.yAxisName,"display","flex")},setDataSource:function(a){this.inherited(arguments);this.dataSource=a;this._calcDataSourceType(this.dataSource)},_calcDataSourceType:function(a){a.layerId?this.dsType="CLIENT_FEATURES":a.frameWorkDsId&&(a=(a=e.getDsTypeInfoMeta(a.frameWorkDsId,this.appConfig))&&a.dsMeta)&&("Features"===a.type?this.dsType="FRAMEWORK_FEATURES":"FeatureStatistics"===
a.type&&(this.dsType="FRAMEWORK_STATISTICS"))},setConfig:function(a){this.config=this._classifyChartConfig(a)},onDataSourceDataUpdate:function(a){a&&"undefined"!==typeof a.features&&(this.inSettingPage&&a.features.length>this.featuresCountForPreview&&(a.features=a.features.slice(0,this.featuresCountForPreview)),this.data=a,this._hasStatisticsed=!!a.hasStatisticsed)},startRendering:function(){this._shouldRenderChart()&&((this.chart||this._createJimuChart(),this._updateBackgroundColor(),this._setyAxisName(),
this._splitConfig(),this._createChartSeriesOption(),this.seriesOption)?this._checkIsTooManyLabels(this.seriesOption)||(this._createChartOption(),this.chart.updateConfig(this.chartOption),this.chart.resize()):this.showNodata())},_createChartOption:function(){var a=this._isSameFeatures(),b=e.isEqual(this.dataOption,this._oldDataOption)&&e.isEqual(this.displayOption,this._oldDisplayOption);a&&b||(this.chartOption=null,this.seriesOption&&(this.chartOption=this.chartDijitOption.updateChartOptionDisplay(n.clone(this.seriesOption),
this.displayOption,this.dataOption),this._oldDisplayOption=null,this._oldDisplayOption=n.clone(this.displayOption)))},_createChartSeriesOption:function(){var a=this._isSameFeatures(),b=e.isEqual(this.dataOption,this._oldDataOption);a&&b||(this._oldDataOption=null,this._oldDataOption=n.clone(this.dataOption),a=this.dataOption,a.features=this.features,b=this.chartDijitOption.getClientStatisticsData(a),this.seriesOption=null,b&&(this.chartDijitOption.bindChartEvent(this.chart,a,b),this.seriesOption=
this.chartDijitOption.getChartOptionSeries(this.dataOption,b)))},_splitConfig:function(){if(this.config){this.config=this._classifyChartConfig(this.config);var a=this.config.data,e=this.config.display;this.features=this._cleanFeatures(this.data.features);var b=this.dataSource.filterByExtent,c=this._isStatisticsed(),b={filterByExtent:b,hasStatisticsed:c};this.dataOption=null;this.dataOption=n.mixin(b,a);this.displayOption=null;this.displayOption=e}},_cleanFeatures:function(a){if(a&&a.length)return a.map(function(a){return{attributes:a.attributes}})},
_isSameFeatures:function(){var a=this.features;if(!a)return!0;a=a.map(function(a){return a.attributes});if(e.isEqual(a,this._oldFeatureAttrs))return!0;this._oldFeatureAttrs=a},_isStatisticsed:function(){return this.inSettingPage?"FRAMEWORK_STATISTICS"===this.dsType:!!this._hasStatisticsed},_shouldRenderChart:function(){if(this.visible&&this.config){var a=this.domNode&&this.data&&this.data.features,e;if("CLIENT_FEATURES"===this.dsType)e=!!this.layerObject;else if("FRAMEWORK_FEATURES"===this.dsType||
"FRAMEWORK_STATISTICS"===this.dsType)e=!!this.featureLayerForFrameWork;if(a&&e){if(this._checkIsTooManyTimeInterval(this.data.features))return this.showNodata(this.nls.parsingperiodTip),!1}else return this.showNodata(),!1;this.hideNodata();return!0}},_getNodataTextColor:function(){var a;a=this.config&&this.config.display;var e=this.config&&this.config.data;if(!a||!e)return"#666";(a="pie"===e.type?a.dataLabelColor:a.horizontalAxisTextColor||a.verticalAxisTextColor)||(a="#666");return a},_classifyChartConfig:function(a){if(a)return a&&
!a.data&&(a=e.classifyChartConfig(a)),this._specialChartConfig(a),a},_specialChartConfig:function(a){var e=a&&a.data;if(e){var k=e.mode,b=e.sortOrder;"feature"===k&&b&&b.field===e.labelField&&(b.isLabelAxis=!0);"undefined"!==typeof e.labelField&&"feature"===k?e.clusterField=e.labelField:"undefined"===typeof e.categoryField||"category"!==k&&"count"!==k||(e.clusterField=e.categoryField)}if(a=a&&a.display)e&&(a.mode=e.mode),a.theme||(a.theme=this._getChartTheme())},showNodata:function(a){f.addClass(this.domNode,
"no-data");this._setNoDataColor();a&&(this.noDataDiv.innerHTML=a)},_setNoDataColor:function(){var a=this._getNodataTextColor();this.noDataDiv&&this.noDataDiv.style&&(this.noDataDiv.style.color=a)},_initChartDijitOption:function(){if(this.chartDijitOption){var a=null,a="CLIENT_FEATURES"===this.dsType?this.layerObject:this.featureLayerForFrameWork;this.chartDijitOption.init(a,this.layerObject,this.popupInfo,this.map)}},_checkIsTooManyLabels:function(a){return(a=a.labels)&&a.length>this.maxLabels?(this.showNodata(this.nls.manyCategoryTip),
!0):!1},_checkIsTooManyTimeInterval:function(e){var b=this.config&&this.config.data,b=b&&b.dateConfig;if(!b||"automatic"===b.minPeriod)return!1;var k=b.categoryField,c=e.map(n.hitch(this,function(a){return a.attributes[k]})),c=c.filter(function(a){return!!a});e=Math.min.apply(Math,c);c=Math.max.apply(Math,c);e=a(e).subtract(1,"seconds").local();c=a(c).add(1,"seconds").local();return Math.round(c.diff(e,b.minPeriod,!0))>=this.maxTimeIntervals},_createChartDijitOption:function(){var a={map:null};this.inSettingPage||
(a.map=this.map);this.chartDijitOption=new b(a)},_init:function(){this._createChartDijitOption();this._updateBackgroundColor()},_createJimuChart:function(){var a=this.config&&this.config.data;this.DEFAULT_CONFIG={type:a&&a.type||"column",theme:this._getChartTheme(),labels:[],series:[{data:[]}]};this.chart=new c({chartDom:this.chartDomNode,config:this.DEFAULT_CONFIG});this.chart.placeAt(this.chartDomNode);this.chart.resize()},_getChartTheme:function(){return this.isDarkTheme()?"dark":"light"},_updateBackgroundColor:function(){var a=
(this.config=this._classifyChartConfig(this.config))&&this.config.display;a&&a.backgroundColor&&this.setBackgroundColor(a.backgroundColor)},hideNodata:function(){f.removeClass(this.domNode,"no-data")}})})},"jimu/dijit/_chartDijitOption":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","jimu/clientStatisticsUtils","jimu/_chartHelpUtils"],function(n,f,h,l,d){return n([f],{postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart},constructor:function(a){this.map=
a.map;this.chartHelpUtils=new d({map:this.map,clientStatisticsUtils:l})},init:function(a,b,c,d){a&&this.chartHelpUtils.setLayerFeatureLayer(a);b&&this.chartHelpUtils.setSymbolLayer(b);c&&this.chartHelpUtils.setPopupInfo(c);d&&this.chartHelpUtils.setMap(d)},getClientStatisticsData:function(a){var b=l.getClietStatisticsData(a),b=l.sortClientStatisticsData(b,a),b=l.getDataForMaxLabels(b,a.maxLabels);return b=this.chartHelpUtils.keepStatisticsDataBestDecimalPlace(a,b,a.mode)},bindChartEvent:function(a,
b,c){this.chartHelpUtils.bindChartEvent(a,b,c)},getChartOptionSeries:function(a,b){return this._createOptionSeries(a,b)},updateChartOptionDisplay:function(a,b,c){this._assigneeSettingColorToSeries(a,b,c);this.chartHelpUtils.updateChartSeriesDisplayName(a,b,c);return this._mapSettingConfigToChartOption(a,b,c)},_assigneeSettingColorToSeries:function(a,b,c){if(!a||!a.series)return a;this.chartHelpUtils.assigneeSettingColor(b,a.series,c)},_createOptionSeries:function(a,b){var c=a.type,d=a.mode;a=a.valueFields;
var g=[],g="count"===d?[""]:"field"===d?[""]:h.clone(a),e=null,e={type:c,labels:[],series:[]};e.series=g.map(h.hitch(this,function(a){return{name:a,type:c,data:[]}}));b.forEach(h.hitch(this,function(a){var b=a.label;e.labels.push(b);for(var c=0;c<a.values.length;c++)e.series[c].data.push({value:a.values[c],name:b,unit:a.unit})}));return e},_mapSettingConfigToChartOption:function(a,b,c){var d=c.type;this._settingColorArrayForPie(a,b,d,c.mode);this._settingAxisDisplay(a,b,d);a.type=d;a.dataZoom=["inside",
"slider"];a.confine=!0;a.backgroundColor=b.backgroundColor;b.marks&&b.marks.markLine&&(a.markLine=h.clone(b.marks.markLine));b.marks&&b.marks.markArea&&(a.markArea=h.clone(b.marks.markArea));b.legend&&(a.legend=h.clone(b.legend));b.xAxis&&(a.xAxis=h.clone(b.xAxis));b.yAxis&&(a.yAxis=h.clone(b.yAxis));b.dataLabel&&(a.dataLabel=h.clone(b.dataLabel));"pie"===d&&(a.innerRadius=b.innerRadius);a.theme=b.theme||"light";return a},_settingColorArrayForPie:function(a,b,c,d){"pie"===c&&"field"!==d&&(b=b.seriesStyle)&&
b.styles&&b.styles[0]&&(b=b.styles[0].style)&&Array.isArray(b.color)&&(c=h.clone(b.color),2===c.length&&(c=this.chartHelpUtils.getColors(h.clone(b.color),6)),a.color=c)},_settingAxisDisplay:function(a,b,c){if(!(0>["column","bar","line"].indexOf(c))){b.stack||(b.stack=!1);if("column"===c||"bar"===c||"line"===c&&b.area)a.stack=b.stack;"line"!==c||b.area||(b.area=!1);"line"===c&&(a.area=b.area);a.axisPointer=!0;a.scale=!1}}})})},"jimu/clientStatisticsUtils":function(){define(["dojo/_base/lang","moment/moment",
"./_chartHelpUtils","jimu/utils"],function(n,f,h,l){window.makeTwix&&window.makeTwix(f);return{getClietStatisticsData:function(d){var a=d.mode;if("feature"===a)return this.getFeatureModeStatisticsData(d);if("category"===a)return this.getCategoryModeStatisticsData(d);if("count"===a)return this.getCountModeStatisticsData(d);if("field"===a)return this.getFieldModeStatisticsData(d)},sortClientStatisticsData:function(d,a){return this.sortStatisticsData(d,a.mode,a.sortOrder,a.clusterField,a.valueFields)},
getDataForMaxLabels:function(d,a){return d&&d.length&&"number"===typeof a&&0<a&&a<d.length?d.slice(0,a):d},getFeatureModeStatisticsData:function(d){var a=d.features,b=d.clusterField,c=d.valueFields;d=void 0!==d.showNullLabelData?d.showNullLabelData:!0;var m=this.separateFeaturesWhetherFieldValueNull(b,a),a=m.notNullLabelFeatures,m=m.nullLabelFeatures,a=d?a.concat(m):a;d=[];return d=a.map(function(a){var e=a.attributes,k=e&&e[b],k=this.convertingNullOrUndefinedAsPlaceholders(k);a={label:k,values:[],
features:[a]};a.values=c.map(function(a){return e[a]});return a}.bind(this))},getCategoryModeStatisticsData:function(d){function a(a){var e=[],p=null,d;for(d in a){p=a[d];d=this.keepFieldValueType(d,p.type,g);var f=this.calcValuesByFeaturesForCatetoryMode(c,p,b,m,k);e.push({label:d,values:f,features:p.features,unit:p.unit})}return e}var b=d.hasStatisticsed,c=d.valueFields,m=d.operation,g=d.dateConfig,e=void 0!==d.showNullLabelData?d.showNullLabelData:!0,k=d.nullValue,p=[],p=this.getCluseringObj(d.clusterField,
d.features,g);d=p.nullLabel;p=a.call(this,p.notNullLabel);d=a.call(this,d);return p=e?p.concat(d):p},getCountModeStatisticsData:function(d){function a(a){var e=[],c=null,d;for(d in a){var c=a[d],m=this.calcValuesByFeaturesForCountMode(c,g);d=this.keepFieldValueType(d,c.type,b);e.push({label:d,values:m,features:c.features,unit:c.unit})}return e}var b=d.dateConfig,c=void 0!==d.showNullLabelData?d.showNullLabelData:!0,m=[],g=d.hasStatisticsed&&!b,m=this.getCluseringObj(d.clusterField,d.features,b);d=
m.nullLabel;m=a.call(this,m.notNullLabel);d=a.call(this,d);return m=c?m.concat(d):m},calcValuesByFeaturesForCountMode:function(d,a){return a?d.features.map(function(a){var b=(a=a.attributes)&&a.STAT_COUNT;"undefined"===typeof b&&(b=a.stat_count);return b}.bind(this)):[d.count]},getFieldModeStatisticsData:function(d){var a=d.hasStatisticsed,b=d.features,c=d.operation,m=d.nullValue,g=[];return g=d.valueFields.map(n.hitch(this,function(e){var k=this.getValuesByValueFieldForFieldMode(e,b,a,c),k=this.calcValueByOperation(k,
c,m);return{label:e,values:[k]}}))},getValuesByValueFieldForFieldMode:function(d,a,b,c){c="average"===c?"avg":c;if(b)var m=l.upperCaseString(d+"_"+c),g=l.lowerCaseString(d+"_"+c);return a.map(n.hitch(this,function(a){if(a=a.attributes){var e;b?(e=a[m],"undefined"===typeof e&&(e=a[g])):e=a[d];return e}}))},sortStatisticsData:function(d,a,b,c,m){function g(a,e,b){var k;"category"===e?b.isLabelAxis?b.isLabelAxis&&(k=a.label):b.field||1!==a.values.length?(b=m.indexOf(b.field),k=a.values[b]):k=a.values[0]:
"count"===e?(k=a.label,k=b.isLabelAxis?k:a.values[0]):"field"===e?k=b.isLabelAxis?a.label:a.values[0]:"feature"===e&&a&&a.features&&a.features[0]&&(a=a.features[0].attributes)&&(k=b.isLabelAxis?a[c]:a[b.field]);return k}if(!b)return d;var e=b.isAsc;if(!Array.isArray(d))return d;d.sort(function(c,p){c=g(c,a,b);p=g(p,a,b);"_NULL\x26UNDEFINED_"===c&&(c=Infinity);"_NULL\x26UNDEFINED_"===p&&(p=Infinity);l.isNumberOrNumberString(c)&&(c=Number(c));l.isNumberOrNumberString(p)&&(p=Number(p));var k=c>p?e:!e;
Infinity===c?k=e:Infinity===p&&(k=!e);var d=0;c!==p&&(d=k?1:-1);return d}.bind(this));return d},convertingNullOrUndefinedAsPlaceholders:function(d){return null===d||void 0===d?"_NULL\x26UNDEFINED_":d},keepFieldValueType:function(d,a,b){"number"===a&&(d=Number(d));b&&"_NULL\x26UNDEFINED_"!==d&&(d=Number(d));return d},calcValuesByFeaturesForCatetoryMode:function(d,a,b,c,m){return d.map(function(g){g=this.getValuesByValueFieldForCategoryMode(g,a.features,b,c);return this.calcValueByOperation(g,c,m)}.bind(this))},
getValuesByValueFieldForCategoryMode:function(d,a,b,c){c="average"===c?"avg":c;if(b)var m=l.upperCaseString(d+"_"+c),g=l.lowerCaseString(d+"_"+c);return a.map(n.hitch(this,function(a){if(a=a.attributes){var e;b?(e=a[m],"undefined"===typeof e&&(e=a[g])):e=a[d];return e}}))},_isNumber:function(d){return"[object number]"===Object.prototype.toString.call(d).toLowerCase()},_getDateUnit:function(d,a){var b=a;"automatic"===a&&(a=f(d[0]).local(),d=f(d[1]).local(),d=Math.round(d.diff(a,"minute",!0)),0<=d&&
1>=d?b="second":1<d&&60>=d?b="minute":60<d&&1440>=d?b="hour":1440<d&&43200>=d?b="day":43200<d&&518400>=d?b="month":518400<d&&(b="year"));return b},_getTimeRange:function(d,a){var b=d.map(n.hitch(this,function(b){return(b=b.attributes)&&b[a]})),b=b.filter(function(a){return!!a});d=Math.min.apply(Math,b);b=Math.max.apply(Math,b);return[d,b]},_getTimeTwixs:function(d,a,b){if(0>"year month day hour minute second automatic".split(" ").indexOf(b))return console.log("Invaild data formatter: "+b),!1;d=this._getTimeRange(d,
a);if(d[0]===d[1])return!1;b=this._getDateUnit(d,b);a=this.getStartTimeByUnit(d[0],b);a=f(a).local();d=f(d[1]).local();d=a.twix(d).split(1,b);a={startValue:d[d.length-1].end().valueOf(),endValue:Infinity};d.push(a);return{twixs:d,dateUnit:b}},getCluseringObj:function(d,a,b){var c={},m={};b?(d=this.getClusteringObjForDateType(d,a,b),c=d.notNullLabel,m=d.nullLabel):(c=this.separateFeaturesWhetherFieldValueNull(d,a),a=c.nullLabelFeatures,c=this.getClusteringObjByField(c.notNullLabelFeatures,d),m=this.getClusteringObjByField(a,
d));return{notNullLabel:c,nullLabel:m}},calcValueByOperation:function(d,a,b){if(d&&1===d.length){if(!b)return d[0];if(!this._isNumber(d[0]))return 0}var c;if(0!==d.length){c=0;"max"===a?c=-Infinity:"min"===a&&(c=Infinity);d=b?d.map(function(a){this._isNumber(a)||(a=0);return a}.bind(this)):d.filter(function(a){return this._isNumber(a)}.bind(this));var m=0;d.forEach(n.hitch(this,function(b){m++;"average"===a||"sum"===a?c+=b:"max"===a?c=Math.max(c,b):"min"===a&&(c=Math.min(c,b))}));0<m?"average"===
a&&(c/=m):c=null}else c=null;return c},getClusteringObjByField:function(d,a){var b={};d.forEach(n.hitch(this,function(c){var d=c.attributes,d=d&&d[a],g=typeof d,d=this.convertingNullOrUndefinedAsPlaceholders(d),e=null;b.hasOwnProperty(d)?(e=b[d],e.features.push(c),e.count++):(e={count:1,features:[c],type:g},b[d]=e)}));return b},_removeNaNDataItem:function(d){return d.filter(function(a){var b=!1;a=a.category;"number"===typeof a&&(b=isNaN(a));return!b})},separateFeaturesWhetherFieldValueNull:function(d,
a){var b=[],c=[];Array.isArray(a)&&(c=a.filter(function(a){var c=a.attributes,c=c&&c[d];if(null===c||void 0===c)b.push(a);else return!0}));return{nullLabelFeatures:b,notNullLabelFeatures:c}},getStartTimeByUnit:function(d,a){return f(d).startOf(a).utc().valueOf()},_mosaicFieldNameWithOperatorAndUpper:function(d,a){return l.upperCaseString(d+"_"+a)},_mosaicFieldNameWithOperatorAndLower:function(d,a){return l.lowerCaseString(d+"_"+a)},getClusteringObjForDateType:function(d,a,b){function c(a,e,b){a[e]?
(a=a[e],a.count+=b.count,a.features=a.features.concat(b.features)):a[e]=b}function m(a,e,b,c){e=Number(e);c=this.getStartTimeByUnit(e,c);a[c]?(a=a[c],a.count+=b.count,a.features=a.features.concat(b.features)):(b.originTime=e,a[c]=b)}function g(a,e,b){b[a[0].attributes[e]]={count:1,features:a};return b}var e=this.separateFeaturesWhetherFieldValueNull(d,a),k=e.notNullLabelFeatures;a={};a=this.getClusteringObjByField(e.nullLabelFeatures,d);e={};if(1===k.length)e=g.call(this,k,d,e,b);else if(0!==k.length){var p=
this._getTimeTwixs(k,d,b.minPeriod);if(p){var f={},r=p.dateUnit;p.twixs.forEach(function(a){var e="undefined"!==typeof a.startValue?a.startValue:a.start().valueOf(),g="undefined"!==typeof a.endValue?a.endValue:a.end().valueOf(),p={unit:r,count:0,features:[]};k.forEach(n.hitch(this,function(a){var b=a.attributes,b=b&&b[d];b>=e&&b<g&&(p.features.push(a),p.count++)}));b.isNeedFilled?c.call(this,f,e,p):0<p.count&&c.call(this,f,e,p)}.bind(this));var p={},q,h;for(q in f)f.hasOwnProperty(q)&&(h=f[q],m.call(this,
p,q,h,r));for(q in p)if(p.hasOwnProperty(q)){h=p[q];var l=h.originTime;delete h.originTime;e[l]=h}}else e=g.call(this,k,d,e,b)}return{notNullLabel:e,nullLabel:a}},_mapOptions:function(d,a){"feature"===a?(a=d.labelField,delete d.labelField,d.clusterField=a,d.showNullLabelData=!0):"category"===a?(a=d.categoryField,delete d.categoryField,d.clusterField=a,d.showNullLabelData=!0):"count"===a?(a=d.categoryField,delete d.categoryField,d.clusterField=a):"field"===a&&(d.showNullLabelData=!0);return d},_mapDataItemForStatisticsChart:function(d,
a){var b,c,m;return d.map(function(g){b=g.label;delete g.label;c=g.values;delete g.values;m=g.features;delete g.features;"feature"===a?(g.category=b,g.valueFields=c,g.dataFeatures=m):"category"===a?(g.category=b,g.valueFields=c,g.dataFeatures=m):"count"===a?(g.fieldValue=b,g.count=c[0],g.dataFeatures=m):"field"===a&&(g.label=b,g.value=c[0]);return g})},getFeatureModeStatisticsInfo:function(d){var a=new h({featureLayer:d.layerDefinition,popupFieldInfosObj:d.popupFieldInfosObj});d=this._mapOptions(d,
"feature");var b=d.clusterField,c=this.getFeatureModeStatisticsData(d),c=this.sortStatisticsData(c,"feature",d.sortOrder,b),c=this.getDataForMaxLabels(c,d.maxLabels),c=a.getBestLabelDisplay(c,b,"feature"),c=a.keepStatisticsDataBestDecimalPlace(d,c,"feature");return this._mapDataItemForStatisticsChart(c,"feature")},getCategoryModeStatisticsInfo:function(d){var a=new h({featureLayer:d.layerDefinition,popupFieldInfosObj:d.popupFieldInfosObj});d=this._mapOptions(d,"category");var b=d.clusterField,c=this.getCategoryModeStatisticsData(d),
c=this.sortStatisticsData(c,"category",d.sortOrder,null,d.valueFields),c=this._removeNaNDataItem(c),c=this.getDataForMaxLabels(c,d.maxLabels),c=a.getBestLabelDisplay(c,b,"category"),c=a.keepStatisticsDataBestDecimalPlace(d,c,"category");return this._mapDataItemForStatisticsChart(c,"category")},getCountModeStatisticsInfo:function(d){var a=new h({featureLayer:d.layerDefinition,popupFieldInfosObj:d.popupFieldInfosObj});d=this._mapOptions(d,"count");var b=d.clusterField,c=this.getCountModeStatisticsData(d),
c=this.sortStatisticsData(c,"count",d.sortOrder),c=this.getDataForMaxLabels(c,d.maxLabels),c=a.getBestLabelDisplay(c,b,"count");return this._mapDataItemForStatisticsChart(c,"count")},getFieldModeStatisticsInfo:function(d){var a=new h({featureLayer:d.layerDefinition,popupFieldInfosObj:d.popupFieldInfosObj});d=this._mapOptions(d,"category");var b=this.getFieldModeStatisticsData(d),b=this.sortStatisticsData(b,"field",d.sortOrder),b=this.getDataForMaxLabels(b,d.maxLabels),b=a.getBestLabelDisplay(b,null,
"field"),b=a.keepStatisticsDataBestDecimalPlace(d,b,"field");return this._mapDataItemForStatisticsChart(b,"field")}}})},"jimu/_chartHelpUtils":function(){define("dojo/_base/declare jimu/utils dojo/_base/lang dojo/_base/config dojo/_base/Color ./_dateFormat moment/moment esri/lang esri/graphic esri/symbols/jsonUtils".split(" "),function(n,f,h,l,d,a,b,c,m,g){return n(null,{constructor:function(a){a&&h.mixin(this,a);this.popupInfo||(this.popupInfo={});this.featureLayer||(this.featureLayer={});this.floatNumberFieldDecimalPlace=
{}},setLayerFeatureLayer:function(a){a&&(this.featureLayer=a)},setSymbolLayer:function(a){a&&(this.symbolLayer=a)},setPopupInfo:function(a){a&&(this.popupInfo=a)},setMap:function(a){a&&(this.map=a)},getBestLabelDisplay:function(a,b,c){if("feature"===c)return this.betterDataCategoryForFeatureMode(a,b);if("category"===c||"count"===c)return this.betterDataCategoryForCategoryCountMode(a,b);if("field"===c)return this.betterDataCategoryForFieldMode(a)},betterDataCategoryForFeatureMode:function(a,b){a.forEach(h.hitch(this,
function(a){a.label=this.getBestDisplayValue(b,a.label)}));return a},betterDataCategoryForFieldMode:function(a){a.forEach(h.hitch(this,function(a){a.label=this.getFieldAlias(a.label)}));return a},betterDataCategoryForCategoryCountMode:function(a,b){a.forEach(h.hitch(this,function(a){a.label="undefined"!==typeof a.unit?this.getCategoryDisplayForDateUnit(a.label,a.unit):this.getBestDisplayValue(b,a.label)}));return a},keepStatisticsDataBestDecimalPlace:function(a,b,c){if("count"===c)return b;var e=
a.features,k=a.clusterField,g=a.valueFields,d=a.operation;a=[];g&&(a=a.concat(g));k&&a.push(k);"feature"===c?(this.calculateDecimalPlaceForFloatField(a,e),b.forEach(h.hitch(this,function(a){g.forEach(h.hitch(this,function(e,b){var c=a.values[b];this.isFloatNumberField(e)&&(c=this.getBestValueForFloatNumberField(c,e),a.values[b]=c)}))}))):"category"===c?(this.calculateDecimalPlaceForFloatField(a,e),b.forEach(h.hitch(this,function(a){g.forEach(h.hitch(this,function(e,b){var c=a.values[b];this.isFloatNumberField(e)?
(c=this.getBestValueForFloatNumberField(c,e),a.values[b]=c):this.isIntegerNumberField(e)&&"average"===d&&(c=this.getBestValueForIntegerFieldAverage(c,6),a.values[b]=c)}))}))):"field"===c&&(this.calculateDecimalPlaceForFloatField(a,e),g.forEach(h.hitch(this,function(a){b.some(h.hitch(this,function(e){if(e.label===a){var b=e.values[0];this.isFloatNumberField(a)?e.values[0]=this.getBestValueForFloatNumberField(b,a):this.isIntegerNumberField(a)&&"average"===d&&(e.values[0]=this.getBestValueForIntegerFieldAverage(b,
6));return!0}return!1}))})));return b},isIntegerNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var e=["esriFieldTypeSmallInteger","esriFieldTypeInteger"];return this.featureLayer.fields.some(h.hitch(this,function(b){return b.name===a&&0<=e.indexOf(b.type)}))},getBestValueForFloatNumberField:function(a,b){if(null===a)return a;b=this._getFloatNumberFieldDecimalPlace(b);return a.toFixed(b)},getBestValueForIntegerFieldAverage:function(a,b){if("number"!==typeof a)return a;
var e=0,c=a.toString().split(".");1===c.length?e=0:2===c.length&&(e=c[1].length);return 0<e?(e>b&&(e=b),a=a.toFixed(e),parseFloat(a)):a},_getFloatNumberFieldDecimalPlace:function(a){var e=0;this.floatNumberFieldDecimalPlace&&(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(e=a));return e},calculateDecimalPlaceForFloatField:function(a,b){this.floatNumberFieldDecimalPlace={};var e=a.filter(h.hitch(this,function(a){return this.isFloatNumberField(a)})),c={};e.forEach(h.hitch(this,function(a){c[a]=
[]}));b&&0<b.length&&b.forEach(h.hitch(this,function(a){var b=a.attributes;b&&e.forEach(h.hitch(this,function(a){var e=b[a];"number"===typeof e&&c[a].push(e)}))}));e.forEach(h.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var e=c[a];if(0<e.length)try{var b=this.getBestDecimalPlace(e);this.floatNumberFieldDecimalPlace[a]=b}catch(v){this.floatNumberFieldDecimalPlace[a]=0,console.error(v)}this.popupInfo&&(e=this.getFormatFromPopupInfo(this.popupInfo,a))&&0<=e.places&&(this.floatNumberFieldDecimalPlace[a]=
e.places)}))},getBestDecimalPlace:function(a){var e=0,b={};a.forEach(function(a){a=a.toString().split(".");var e=null;1===a.length?e=0:2===a.length&&(e=a[1].length);null!==e&&(b[e]=void 0===b[e]?1:b[e]+1)});a=null;for(var c in b){c=parseInt(c,10);var g=b[c];a?g>a.value&&(a={key:c,value:g}):a={key:c,value:g}}a&&(e=parseInt(a.key,10));return e},getFormatFromPopupInfo:function(a,b){var e=null;if(!a)return e;(a=a.fieldInfos)&&0<a.length&&a.forEach(function(a){a.fieldName===b&&(e=a.format)});return e},
getAliasFromPopupInfo:function(a,b){var e=b;if(!a)return e;(a=a.fieldInfos)&&0<a.length&&a.forEach(function(a){a.fieldName===b&&(e=a.label)});return e},isFloatNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var e=["esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(b){return b.name===a&&0<=e.indexOf(b.type)}))},isNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var e=["esriFieldTypeSmallInteger",
"esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(b){return b.name===a&&0<=e.indexOf(b.type)}))},isDateField:function(a){return(a=this.getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},getFieldInfo:function(a){if(this.featureLayer)for(var e=this.featureLayer.fields,b=0;b<e.length;b++)if(e[b].name===a)return e[b];return null},getFieldAliasArray:function(a){return a.map(h.hitch(this,function(a){return this.getFieldAlias(a)}))},
getBestDisplayValue:function(a,b){return"_NULL\x26UNDEFINED_"===b?"null":this.isDateField(a)?this.formatedDateByPopupInfoOrLocal(a,b):this.getDisplayValForNumberCodedValueSubTypes(a,b)},formatedDateByPopupInfoOrLocal:function(a,b,g){g||(g=this.popupInfo);a:{if(g&&c.isDefined(g.fieldInfos))for(var e=0,k=g.fieldInfos.length;e<k;e++){var d=g.fieldInfos[e];if(d.fieldName===a){a=d.format;break a}}a=null}b=Number(b);return f.fieldFormatter.getFormattedDate(b,a)},getDisplayValForNumberCodedValueSubTypes:function(a,
b){var e=this.tryLocaleNumber(b,a);if(this.featureLayer&&this.featureLayer.typeIdField===a){var c=this.featureLayer.types;if(c&&0<c.length&&(c=c.filter(h.hitch(this,function(a){return a.id===b})),0<c.length))return e=c[0].name}(a=this.getFieldInfo(a))&&a.domain&&(a=a.domain.codedValues)&&0<a.length&&a.some(function(a){return a.code===b?(e=a.name,!0):!1});return e},tryLocaleNumber:function(a,b){var e=a;if(c.isDefined(a)&&isFinite(a))try{var k;if(b&&this.isNumberField(b)){var g=this.popupInfo[b];k=
g&&h.exists("format.places",g)?f.localizeNumberByFieldInfo(a,g):f.localizeNumber(a)}else k=a;"string"===typeof k&&(e=k)}catch(q){console.error(q)}return e+""},getCategoryDisplayForDateUnit:function(a,b){if(!b)return a;a=Number(a);return this._getFormatteredDate(a,b)},_getFormatteredDate:function(a,c){var e=this._getDateTemplate(c);0<=["year","month","day"].indexOf(c)?e=f.localizeDate(new Date(a),{selector:"date",datePattern:e.date}):(c=f.localizeDate(new Date(a),{selector:"date",datePattern:e.date}),
a=b(a).format(e.time),e=c+e.connector+a);return e},_getDateTemplate:function(b){var e=a[l.locale];(e=e||{},e.date)||(e.date={"short":"short"});e&&!e.time&&(e.time={medium:"HH:mm:ss a"});e&&!e.connector&&(e.connector=" ");e&&!e.sNoDay&&(e.sNoDay="MMM, y");var c={};"year"===b?c.date="y":"month"===b?c.date=e.date.sNoDay:"day"===b?c.date=e.date["short"]:"hour"===b?(c.date=e.date["short"],c.time="HH a",c.connector=e.connector):"minute"===b?(c.date=e.date["short"],c.time="HH:mm a",c.connector=e.connector):
"second"===b&&(c.date=e.date["short"],c.time=e.time.medium,c.connector=e.connector);return c},_getSymbolLayerGraphics:function(a){if(!this.symbolLayer)return null;if(!this.symbolLayer.refreshInterval&&this.symbolGraphics&&this.symbolGraphics.filterByExtent===a)return this.symbolGraphics.graphics;var b=null;this.map&&this.symbolLayer&&(b=f.getClientFeaturesFromMap(this.map,this.symbolLayer,!1,!!a));this.symbolGraphics={filterByExtent:a,graphics:b};return b},_isContainAttr:function(a,b){if("object"!==
typeof b||"object"!==typeof b)return!1;var e=!0,c;for(c in b)b.hasOwnProperty(c)&&(e=b[c]===a[c]);return e},_getFeaturesByAttr:function(a,b){if(b){var e=null;b.some(function(b){return this._isContainAttr(b.attributes,a)?(e=b,!0):!1}.bind(this));return e}},_getFeaturesByClusterfield:function(a,b,c,g){var e=this._getSymbolLayerGraphics(c);if(e)return c=null,a=this.clientStatisticsUtils.getCluseringObj(a,e,g),(b=h.mixin(a.notNullLabel,a.nullLabel)[b])&&b.features&&b.features.length&&(c=b.features),c},
_getFeatureForSerieData:function(a,b,c){var e=b.clusterField,k=b.mode;b=b.filterByExtent;var g={};g[e]=a.name;if("feature"===k)return this._getFeatureBySerieDataItem(a,e,c,b);if("category"===k||"count"===k)return new m(null,null,g)},_getFeatureBySerieDataItem:function(a,b,c,g){var e={};e[b]=a.name;e[c]=Number(a.value);a=this._getSymbolLayerGraphics(g);return this._getFeaturesByAttr(e,a)},_getFeatureBycsuDataItem:function(a,b,c,g,d){var e={};e[b]=a.label;e[c]=Number(a.values&&a.values[g]);a=this._getSymbolLayerGraphics(d);
return this._getFeaturesByAttr(e,a)},bindChartEvent:function(a,b,c){var e=b.filterByExtent,k=b.clusterField,g=null;"undefined"!==b.dateConfig&&(g=b.dateConfig);this.highLightColor=b.highLightColor||"#00ffff";var d=b.mode;this.map&&0!==c.length&&(b=h.hitch(this,function(a){if("series"===a.componentType){var b=null,m=this._getSymbolLayerGraphics(e);if("field"===d)b=m;else if(m=c[a.dataIndex])if("feature"===d){var f=a.seriesName;if(!f)return;(m=this._getFeatureBycsuDataItem(m,k,f,a.seriesIndex,e))&&
(b=[m])}else m=m.label,"undefined"!==typeof m&&(b=this._getFeaturesByClusterfield(k,m,e,g));b&&("mouseover"===a.type?this._mouseOverChartItem(b):"mouseout"===a.type&&this._mouseOutChartItem(b))}}),[{name:"mouseover",callback:b},{name:"mouseout",callback:b}].forEach(h.hitch(this,function(b){a.chart.off(b.name);a.chart.on(b.name,h.hitch(this,function(a){"mouseover"===a.type?(this._hasTriggerMouseoverEvent||(this._hasTriggerMouseoverEvent=!0,b.callback(a)),setTimeout(h.hitch(this,function(){this._hasTriggerMouseoverEvent=
!1},500))):"mouseout"===a.type&&b.callback(a)}))})))},_mouseOverChartItem:function(a){this._removeTempGraphics();this._mouseOutChartItem(a);a.forEach(h.hitch(this,function(a){a._originalSymbol=a.symbol}));if(this.featureLayer&&this.featureLayer.getMap()&&this.featureLayer.visible){var b=f.getTypeByGeometryType(this.featureLayer.geometryType),e=null;if("point"===b)e=this._getHighLightMarkerSymbol(),this.tempGraphics=[],a.forEach(h.hitch(this,function(a){a=new m(a.geometry,e);this.tempGraphics.push(a);
this.featureLayer.add(a)}));else if("polyline"===b)e=this._getHighLightLineSymbol(this.highLightColor),a.forEach(h.hitch(this,function(a){a.setSymbol(e)}));else if("polygon"===b){var c=this.featureLayer.getSelectedFeatures()||[];a.forEach(h.hitch(this,function(a){var b=0<=c.indexOf(a),b=this._getHighLightFillSymbol(this.featureLayer,a,b);a.setSymbol(b)}));this._getSymbolLayerGraphics(!1).length!==a.length&&"polygon"===b&&(a.forEach(h.hitch(this,function(a){this.featureLayer.remove(a)})),a.forEach(h.hitch(this,
function(a){this.featureLayer.add(a)})))}}},_mouseOutChartItem:function(a){this._removeTempGraphics();a.forEach(h.hitch(this,function(a){a.setSymbol(a._originalSymbol||null)}))},_removeTempGraphics:function(){if(this.featureLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.featureLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=null},_getHighLightMarkerSymbol:function(){var a=g.fromJson({color:[255,255,255,0],size:18,angle:0,
xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}});a.setSize(30);a.outline.setColor(new d(this.highLightColor));return a},_getHighLightLineSymbol:function(a){var b=g.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});b.setColor(new d(a||this.highLightColor));return b},_getDefaultHighLightFillSymbol:function(){var a=g.fromJson({color:[0,255,255,128],outline:{color:[0,255,255,255],width:1.5,
type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"});a.outline.setColor(new d(this.highLightColor));return a},_getSymbolByRenderer:function(a,b){var c=this._getDefaultHighLightFillSymbol(),e=this.getVisualVariableByType("colorInfo",a.visualVariables);if(e){if(a=a.getColor(b,{colorInfo:e}))a=h.clone(a),c.setColor(a)}else c=a.getSymbol(b);return c},getVisualVariableByType:function(a,b){return b&&(b=b.filter(function(b){return b.type===a&&!b.target}),b.length)?b[0]:null},_getHighLightFillSymbol:function(a,
b,c){var e=null,k=b.symbol,e=a.renderer;!k&&e&&(k=this._getSymbolByRenderer(e,b));k&&"function"===typeof k.setOutline?(e=g.fromJson(k.toJson()),b=1.5,k.outline&&0<k.outline.width&&(b=k.outline.width+1),c=this._getHighLightLineSymbol(c?"#ff0000":"#00ffff"),c.setWidth(b),e.setOutline(c)):e=this._getDefaultHighLightFillSymbol();return e},_isNumberField:function(a){var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,
function(c){return c.name===a&&0<=b.indexOf(c.type)}))},getFieldAlias:function(a){var b=a;(a=this.getFieldInfo(a))&&(b=a.alias||b);this.popupInfo&&(b=this.getAliasFromPopupInfo(this.popupInfo,b));return b},_removeDuplicateElementForObjArray:function(a){if(!Array.isArray(a))return a;var b=[];b.push(a[0]);a.forEach(function(a){b.some(function(b){return f.isEqual(b,a)})||b.push(a)});return b},assigneeSettingColor:function(a,b,c){if(!b||!b.length)return b;var e=a.seriesStyle;if(!e)return b;"layerSymbol"===
e.type?b=this._assigneeStyleLayerSymbolColor(b,c):"series"===e.type?b=this._assigneeStyleSeriesColor(a,b):"custom"===e.type&&(b=this._assigneeStyleCustomColor(a,b));return b},_assigneeStyleCustomColor:function(a,b){a=a.seriesStyle;if(!a||!a.customColor)return b;var c=a.customColor;a=c.categories;c=c.others;if(!(a&&a.length||c&&c.length))return b;c&&c.length&&this._setCustomOthersColor(c,b);a&&a.length&&this._setCustomCategoriesColor(a,b)},_setCustomCategoriesColor:function(a,b){b.forEach(function(b){(b=
b.data)&&b.length&&b.forEach(function(b){if("undefined"!==typeof b.name){var c=this._getMatchingCustomColor(b.name,a);this.setColorToDataItem(b,c)}}.bind(this))}.bind(this))},_getMatchingCustomColor:function(a,b){var c=!1;if(!b||!b.length)return c;(b=b.filter(function(b){return b.id===a})[0])&&b.color&&(c=b.color);return c},_getMatchingCustomLabel:function(a,b){var c=!1;if(!b||!b.length)return c;(b=b.filter(function(b){return b.id===a})[0])&&b.label&&(c=b.label);return c},_setCustomOthersColor:function(a,
b){this._setOtherColorForCustomColor(a,b);this._setNullLabelColorForCustomColor(a,b)},_setOtherColorForCustomColor:function(a,b){(a=a.filter(function(a){return"others"===a.id})[0])&&a.color&&this.setColorToAllSerieDataItem(b,a.color)},_setNullLabelColorForCustomColor:function(a,b){if((a=a.filter(function(a){return"null"===a.id})[0])&&a.color){var c=a.color;b.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){a.name&&"_NULL\x26UNDEFINED_"===a.name&&this.setColorToDataItem(a,c)}.bind(this))}.bind(this))}},
_assigneeStyleSeriesColor:function(a,b){var c=a.seriesStyle;if(!c||!c.styles||!c.styles[0])return b;var e=a.mode,k=a.area;return b.map(function(a){var b=null,g=a.type;if("field"===e)"line"===g?(b=c.styles[0].style,a=this._setStyleToSerie(b,a,k)):(g=a.data)&&g[0]&&(a.data=g.map(function(a){b=this._getMatchingStyle(a.name,c);return this.setStyleToSerieDataItem(b,a)}.bind(this)));else if("column"===g||"bar"===g||"line"===g)"count"===e?(b=c.styles[0].style,a=this._setStyleToSerie(b,a,k)):"undefined"!==
typeof a.name&&(b=this._getMatchingStyle(a.name,c))&&(a=this._setStyleToSerie(b,a,k));return a}.bind(this))},_assigneeStyleLayerSymbolColor:function(a,b){a.forEach(function(a){var c=a.name;(a=a.data)&&a.length&&a.forEach(function(a){var e=[this._getFeatureForSerieData(a,b,c)];if(e=this._getSymbolColorForDataItem(e))a.itemStyle={color:e}}.bind(this))}.bind(this))},_setStyleToSerie:function(a,b,c){b.itemStyle||(b.itemStyle={});a&&"undefined"!==typeof a.color&&(Array.isArray(a.color)?b.itemStyle.color=
a.color[0]:b.itemStyle.color=a.color);a&&"undefined"!==typeof a.opacity&&(c?(b.areaStyle||(b.areaStyle={}),b.areaStyle.opacity=1-parseFloat(a.opacity/10)):b.itemStyle.opacity=1-parseFloat(a.opacity/10));return b},_getMatchingStyle:function(a,b){var c=null;b=b.styles;if(!b||!b[0]||""===a)return c;b.forEach(function(b){b.name===a&&(c=b.style)});return c},_getSymbolColorForDataItem:function(a){var b=!1;if(!this.symbolLayer)return b;a=a&&a[0];return a?b=this._getColorForFeature(this.symbolLayer.renderer,
a):b},_getColorForFeature:function(a,b){var c=!1,e=this.getVisualVariableByType("colorInfo",a.visualVariables);e?(a=a.getColor(b,{colorInfo:e}))&&(c=this._convertToEchartsRbga(a)):(a=a.getSymbol(b))&&"undefined"!==typeof a.color&&(c=this._convertToEchartsRbga(a.color));return c},_convertToEchartsRbga:function(a){if(!a||"undefined"===typeof a.r)return a;a=window.JSON.parse(window.JSON.stringify(a));var b;b="rgba("+(a.r+",");b+=a.g+",";b+=a.b+",";return b+=a.a+")"},getColors:function(a,b){var c=[];
if(2===a.length)c=this._createGradientColors(a[0],a[a.length-1],b);else{for(var e=Math.ceil(b/a.length),g=0;g<e;g++)c=c.concat(a);c=c.slice(0,b)}return c},_createGradientColors:function(a,b,c){var e=[];a=new d(a);var g=new d(b);b=(g.r-a.r)/c;for(var k=(g.g-a.g)/c,g=(g.b-a.b)/c,m=new d,f=0,p=0,h=0,l=0;l<c;l++)f=parseInt(a.r+b*l,10),p=parseInt(a.g+k*l,10),h=parseInt(a.b+g*l,10),m.setColor([f,p,h]),e.push(m.toHex());return e},setStyleToSerieDataItem:function(a,b){b.itemStyle||(b.itemStyle={});a&&"undefined"!==
typeof a.color&&(Array.isArray(a.color)?b.itemStyle.color=a.color[0]:b.itemStyle.color=a.color);a&&"undefined"!==typeof a.opacity&&(b.itemStyle.opacity=1-parseFloat(a.opacity/10));return b},setColorToSerie:function(a,b){if(!a||"object"!==typeof a||Array.isArray(a))return a;a.itemStyle||(a.itemStyle={});b&&(a.itemStyle.color=b)},setColorToDataItem:function(a,b){if(!a||"object"!==typeof a)return a;a.itemStyle||(a.itemStyle={});b&&(a.itemStyle.color=b)},setColorToAllSerieDataItem:function(a,b){a.forEach(function(a){(a=
a.data)&&a.length&&a.forEach(function(a){this.setColorToDataItem(a,b)}.bind(this))}.bind(this))},updateChartSeriesDisplayName:function(a,b,c){var e="feature"===c.mode?c.labelField:c.categoryField,g=c.mode;c=a.series;var d=[];b=b.seriesStyle;if("custom"===b.type&&(b=b.customColor)&&b.categories&&b.categories.length){var k=b.categories,m;(b=(b.others||[]).filter(function(a){return"null"===a.id})[0])&&b.label&&(m=b.label);c.forEach(function(a,b){(a=a.data)&&a.length&&a.forEach(function(a,c){if("undefined"!==
typeof a.name){var e=a.name;if("_NULL\x26UNDEFINED_"===a.name&&m)e=m;else{var g=this._getMatchingCustomLabel(a.name,k);g&&(e=g)}a.name=e;0===b&&(d[c]=e)}}.bind(this))}.bind(this))}c.forEach(function(a,b){a.name&&(a.name=this.getFieldAlias(a.name));(a=a.data)&&a.length&&a.forEach(function(a,c){var k=a.name,m=k,m=a.unit&&k?this.getCategoryDisplayForDateUnit(k,a.unit):"field"!==g?this.getBestDisplayValue(e,k):this.getFieldAlias(k);a.name=m;0===b&&(d[c]=m)}.bind(this))}.bind(this));a.labels=null;a.labels=
d}})})},"jimu/_dateFormat":function(){define([],function(){return{ar:{date:{"short":"d/M/y",medium:"dd/MM/y","long":"d MMMM. y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"M/y"},time:{"short":"h:mm a",medium:"h:mm:ss a"}},bs:{date:{"short":"d.M.yy.",medium:"d. MMM. y.","long":"d. MMMM y.",onlyDate:"d. MMM.",mNoDay:"MMM. y.",sNoDay:"M.yy"}},cs:{date:{"short":"dd.MM.yy",medium:"d. M. y",onlyDate:"d. M.",mNoDay:"M. y",sNoDay:"MM.yy"}},da:{date:{"short":"dd/MM/y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",
mNoDay:"MMM y",sNoDay:"MM/y"}},de:{date:{"short":"dd.MM.yy",medium:"dd.MM.y",onlyDate:"dd.MM."},connector:" , ",mNoDay:"MM.y",sNoDay:"MM.yy"},el:{date:{"short":"d/M/yy",medium:"d MMM y",onlyDate:"d MMM"},connector:" , ",mNoDay:"MMM y",sNoDay:"M/yy"},en:{date:{"short":"M/d/yy",medium:"MMM d, y",onlyDate:"MMM d",mNoDay:"MMM, y",sNoDay:"M/yy"}},es:{date:{"short":"d/M/yy",medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},et:{date:{"short":"d.MM.y",medium:"d. MMM y",onlyDate:"d. MMM",mNoDay:"MMM y",
sNoDay:"MM.y"},time:{"short":"H:mm",medium:"H:mm:ss"}},fi:{date:{"short":"d.M.y",medium:"d.M.y",onlyDate:"d.M.",mNoDay:"M.y",sNoDay:"M.y"},connector:" 'klo' "},fr:{date:{"short":"dd/MM/y",medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/y"},connector:" '\u00e0' "},he:{date:{"short":"dd/MM/yy",medium:"d '\u05d1'MMM y",onlyDate:"d '\u05d1'MMM",mNoDay:"'\u05d1'MMM y",sNoDay:"MM/yy"},connector:" , "},hi:{date:{"short":"d/M/yy",medium:"dd/MM/y","long":"d MMMM y",onlyDate:"dd/MM",mNoDay:"MM/y",
sNoDay:"M/yy"},time:{"short":"h:mm a",medium:"h:mm:ss a",sNoDay:""},connector:" , "},hr:{date:{"short":"d.M.y",medium:"d. MMM y.",onlyDate:"d. MMM",mNoDay:"MMM y.",sNoDay:"M.y"}},id:{"short":"dd/MM/yy",date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/yy"}},it:{date:{medium:"dd MMM y","long":"d MMMM y",onlyDate:"dd MMM",mNoDay:"MMM y",sNoDay:"MM/yy"},connector:" , "},ja:{date:{medium:"y/MM/dd",onlyDate:"MM/dd",mNoDay:"y/MM",sNoDay:"y/MM"},time:{"short":"a h:mm",medium:"a h:mm:ss"}},
ko:{date:{medium:"y. M. d.",onlyDate:"M. d.",mNoDay:"y. M.",sNoDay:"yy. M."}},lt:{date:{medium:"y-MM-dd","long":"y 'm'. MMMM d 'd'.",onlyDate:"MM-dd",mNoDay:"y-MM",sNoDay:"y-MM"},time:{medium:"HH:mm:ss"}},lv:{date:{"short":"dd.MM.y",medium:"y. 'gada' d. MMM.","long":"y. 'gada' d. MMMM",onlyDate:"d. MMM.",mNoDay:"y. 'gada' MMM.",sNoDay:"MM.y"}},nb:{date:{"short":"dd.MM.y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"HH:mm",medium:"HH:mm:ss"},connector:" , "},
nl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM-yy"}},pl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},"pt-br":{date:{"short":"dd/MM/y",medium:"d 'de' MMM 'de' y",onlyDate:"d 'de' MMM",mNoDay:"MMM 'de' y",sNoDay:"MM/y"}},"pt-pt":{date:{medium:"dd/MM/y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"MM/yy"}},ro:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},ru:{date:{"short":"dd.MM.y",medium:"d MMM y '\u0433.'",
onlyDate:"d MMM",mNoDay:"MMM y '\u0433.'",sNoDay:"MM.y"},connector:" , "},sr:{date:{medium:"dd.MM.y.",onlyDate:"dd.MM.",mNoDay:"MM.y.",sNoDay:"M.yy."},time:{"short":"HH:mm",medium:"HH:mm:ss"}},sv:{date:{medium:"d MMM. y",onlyDate:"d MMM.",mNoDay:"MMM. y",sNoDay:"y-MM"}},th:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},tr:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"}},vi:{date:{"short":"dd/MM/y",medium:"d MMM, y","long":"'Ng\u00e0y' dd 'th\u00e1ng' MM 'n\u0103m' y",
onlyDate:"d MMM",mNoDay:"MMM, y",sNoDay:"MM/y"},time:{"short":"hh:mm a",medium:"hh:mm:ss a"},connector:" , "},"zh-cn":{date:{"short":"y/M/d",medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}},"zh-hk":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"M/y"}},"zh-tw":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}}}})},
"jimu/dijit/Chart":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/Evented libs/echarts/echarts jimu/utils ./_chartUtils ./_Gauge ./_ChartOptionFactory libs/echarts/light libs/echarts/dark".split(" "),function(n,f,h,l,d,a,b,c,m,g){return n([f,d],{baseClass:"jimu-dijit-chart",templateString:"\x3cdiv\x3e\x3c/div\x3e",declaredClass:"jimu.dijit.chart",config:null,postCreate:function(){this.inherited(arguments);this._initChart()},updateConfig:function(a){if(!a)return!1;
this.config=a;this._specialThemeByConfig(a);var b=this._chartFactory(a);this.chart.setOption(b,!0);this._settingByGrid(a,b);return!0},_settingByGrid:function(a,b){if("gauge"===a.type)return this._resetGaugePosition(a);var c=this.chartUtils.getAxisZeroPosition();a.layout=this.chartUtils.calcDefaultLayout(a);this.chartUtils.isAxisChart(a)&&(b=this.chartUtils.settingGrid(b,a),b=this.chartUtils.settingDataZoom(b,a,c));b=this.chartUtils.settingChartLayout(b,a);this.chart.setOption(b,!1)},_resetGaugePosition:function(a){this._resetGaugeGrid(a);
this._resetGaugeGraphic(a)},setConfig:function(a){if(!a)return!1;this.config=a;this._specialThemeByConfig(this.config);this.clear();var b=this._chartFactory(this.config);this.chart.setOption(b,!0);this._setAixsGrid(a,b);this._resetGaugePosition(a,b);return!0},destroy:function(){this._offEvents();this.clear();this.inherited(arguments)},_chartFactory:function(a){return this.option=this.chartOptionFactory.produceOption(a)},bindEvents:function(a){this.chart&&a.events&&a.events.length&&(this._offEvents(),
a.events.forEach(h.hitch(this,function(a){this.chart.on(a.name,a.callback)})))},_offEvents:function(){this.config.events&&this.config.events[0]&&this.config.events.forEach(h.hitch(this,function(a){this.chart.off(a.name)}))},getDataURL:function(){if(this.chart)return this.chart.getDataURL()},clear:function(){this.chart&&this.chart.clear()},resize:function(a,b){this.chart&&(l.setStyle(this.domNode,{width:a||"100%",height:b||"100%"}),this.chart.resize(),this._resizeDataZoom(),this._resetGaugePosition(this.config))},
_resizeDataZoom:function(){var a=this.option,b=this.config;if(a&&b){var c=this.chartUtils.getAxisZeroPosition(),a=this.chartUtils.settingDataZoom(a,b,c);this.chart.setOption(a)}},_setAixsGrid:function(a,b){this.chartUtils.isAxisChart(a)&&(b=this.chartUtils.settingGrid(b,a),this.chart.setOption(b,!1))},_resetGaugeGraphic:function(a){"gauge"===a.type&&this.gauge.resetGraphic(a)},_resetGaugeGrid:function(a){"gauge"===a.type&&this.gauge.resetGrid(a)},_specialChartTheme:function(){this.chart&&(this.chart._theme.tooltip.axisPointer=
{type:"cross",label:{show:!0,precision:2,formatter:function(a){return"number"===typeof a.value?(a=parseFloat(a.value).toFixed(2),this.chartUtils.tryLocaleNumber(a)):a.value}.bind(this)},lineStyle:{color:"#27727B",type:"dashed"},crossStyle:{color:"#27727B"},shadowStyle:{color:"rgba(200,200,200,0.3)"}},this.chart._theme.valueAxis||(this.chart._theme.valueAxis={}),this.chart._theme.valueAxis.axisLabel||(this.chart._theme.valueAxis.axisLabel={}),this.chart._theme.valueAxis.axisLabel.formatter=function(a){return b.localizeNumber(a)})},
_specialThemeByConfig:function(a){this._initChartTheme();a.color&&a.color[0]&&(this.chart._theme.color=a.color);a.confine&&(this.chart._theme.tooltip.confine=!0);var b="percent"===a.stack;this.chart._theme.tooltip.formatter=function(a){return this.chartUtils.handleToolTip(a,null,!1,b)}.bind(this)},_initChartTheme:function(){this.chart&&(this.chart._theme||(this.chart._theme={}),this.chart._theme.tooltip||(this.chart._theme.tooltip={}),this.chart._theme.valueAxis||(this.chart._theme.valueAxis={}),
this.chart._theme.valueAxis.axisLabel||(this.chart._theme.valueAxis.axisLabel={}))},_initChart:function(){this.chart=a.init(this.domNode,this.config&&this.config.theme||"light");this.chartUtils=new c({chart:this.chart});this.gauge=new m({chart:this.chart,chartUtils:this.chartUtils});this.chartOptionFactory=new g({chart:this.chart,gauge:this.gauge,chartUtils:this.chartUtils});this._specialChartTheme(this.config)}})})},"jimu/dijit/_chartUtils":function(){define(["dojo/_base/declare","jimu/utils","esri/lang",
"dojo/_base/lang"],function(n,f,h,l){var d={curved:{name:"",type:"gauge",center:["50%","60%"],startAngle:200,endAngle:-20,axisLine:{lineStyle:{color:[[.31,"#5CB4CA"],[1,"#E5E5E5"]],shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:0}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{distance:-52,textStyle:{color:"#000"}},pointer:{length:"65%",width:5},itemStyle:{opacity:.7},detail:{show:!0,offsetCenter:[0,"60%"],textStyle:{color:"#24B5CC"}},title:{show:!1},data:[{value:0}],animationEasingUpdate:"bounceOut",
animationDurationUpdate:500},vertical:{yAxis:{show:!0,offset:-10,type:"value",interval:1,scale:!1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal"}},splitLine:{show:!1}},xAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{color:"#E5E5E5"},barGap:"-100%",data:[100],z:1},{name:"",type:"bar",barWidth:30,label:{show:!0,position:"insideTopLeft",
offset:[30,-15],textStyle:{}},data:[{value:40,label:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},itemStyle:{}}],itemStyle:{color:"#24B5CC"},z:10}]},horizontal:{xAxis:{show:!0,offset:-27,type:"value",scale:!1,interval:1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},splitLine:{show:!1}},yAxis:{show:!1,
type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{color:"#E5E5E5"},barGap:"-100%",data:[100],z:1},{name:"",type:"bar",barWidth:30,label:{show:!0,position:"top",offset:[20,0],textStyle:{}},data:[{value:40,label:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},itemStyle:{}}],itemStyle:{color:"#24B5CC"},z:10}]}};return n([],{constructor:function(a){this.chart=a&&a.chart;this.horIconUrl="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjdweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA3IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3NS4wMDAwMDAsIC0yOTcuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuNTAwMDAwLCAxNzAuNTQzODAzKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtMi41MDAwMDAsIC0xNzAuNTQzODAzKSAiIHBvaW50cz0iNSAxNzAuNTQzODAzIC0xLjcwNTMwMjU3ZS0xMyAxNzQuMDQzODAzIC0xLjY5NjQyMDc4ZS0xMyAxNjcuMDQzODAzIj48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d";
this.verIconUrl="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA1IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3Ni4wMDAwMDAsIC0zMjQuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMwLjYyODk1MiwgMTcwLjQ1ODY1NCkgcm90YXRlKC05MC4wMDAwMDApIHRyYW5zbGF0ZSgtMzAuNjI4OTUyLCAtMTcwLjQ1ODY1NCkgIiBwb2ludHM9IjMzLjEyODk1MjMgMTcwLjQ1ODY1NCAyOC4xMjg5NTIzIDE3My45NTg2NTQgMjguMTI4OTUyMyAxNjYuOTU4NjU0Ij48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d";
this.verIconUrlRTL="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI3cHgiIHZpZXdCb3g9IjAgMCA1IDciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkFydGJvYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIxLjAwMDAwMCwgLTQ0Ny4wMDAwMDApIiBmaWxsPSIjOTM5MzkzIj4NCiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJUcmlhbmdsZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIzLjUwMDAwMCwgNDUwLjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTEyMy41MDAwMDAsIC00NTAuNTAwMDAwKSAiIHBvaW50cz0iMTI2IDQ1MC41IDEyMSA0NTQgMTIxIDQ0NyI+PC9wb2x5Z29uPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+";
a=l.clone(d);this.curved=a.curved;this.vertical=a.vertical;this.horizontal=a.horizontal;this.unitDistance=23;this.defultGrid={top:10,bottom:10,left:10,right:10,containLabel:!0}},getAxisZeroPosition:function(){if(!this.chart)return!1;var a;try{a=this.chart.convertToPixel({xAxisIndex:0,yAxisIndex:0},[0,0])}catch(g){}if(!a)return{};var b=a[0];a=a[1];var c=this.chart.getHeight(),d=this.chart.getWidth();return{left:b,right:d-b,top:a,bottom:c-a}},getTextWidth:function(a,b){if(!a&&0!==a)return 0;var c=(this.getTextWidth.canvas||
(this.getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");c.font=b;return c.measureText(a).width},getHeightByFontSize:function(a){a=Math.round(a);if("number"!==typeof a||6>a||40<a)return 0;var b=0;a-=6;switch(!0){case 7>=a:b=1*a;break;case 8<=a&&11>=a:b=1*(a-1)+2;break;case 12<=a&&15>=a:b=1*(a-2)+4;break;case 16<=a&&19>=a:b=1*(a-3)+6;break;case 20<=a&&21>=a:b=1*(a-4)+8;break;case 22<=a&&23>=a:b=1*(a-5)+8;break;case 24<=a&&27>=a:b=1*(a-6)+10;break;case 28<=a&&31>=a:b=1*(a-7)+12;
break;case 32<=a&&34>=a:b=1*(a-8)+14}return 8+b},tryLocaleNumber:function(a){var b=a;if(h.isDefined(a)&&isFinite(a))try{var c=f.localizeNumber(a);"string"===typeof c&&(b=c)}catch(m){console.error(m)}return b+""},isAxisChart:function(a){return"column"===a.type||"bar"===a.type||"line"===a.type},isBaseChartType:function(a){return this.isAxisChart(a)||"pie"===a.type},_getTooltipDisplayValue:function(a,b){"number"===typeof Number(a)&&(a=b?f.convertNumberToPercentage(a):this.tryLocaleNumber(a));return a},
generateToolTip:function(a,b,c,d,g){var e="",e=c?'\x3cdiv class\x3d"tooltip-tr reverse"\x3e':'\x3cdiv class\x3d"tooltip-tr"\x3e';c="";a.color&&"auto"!==a.color&&(c='\x3cdiv class\x3d"colorEl marginRight5" style\x3d"background-color:'+f.encodeHTML(a.color)+'"\x3e\x3c/div\x3e');e+=c;c="";"radar"!==a.seriesType&&this._isVaildValue(a.seriesName)?c=a.seriesName:this._isVaildValue(g)&&(c=g);e=""===c?e+("\x3cdiv\x3e"+c+"\x3c/div\x3e"):e+("\x3cdiv\x3e"+c+"\x3c/div\x3e\x3cdiv\x3e : \x3c/div\x3e");g="null";
this._isNotZeroBoolean(b)?g=b:this._isVaildValue(a.value)&&(g=a.value);e+="\x3cdiv\x3e"+this._getTooltipDisplayValue(g,d)+"\x3c/div\x3e";"pie"===a.seriesType&&(a=a.percent,a=this._isVaildValue(a)?a/100:0,e+='\x3cdiv class\x3d"space-left"\x3e('+f.convertNumberToPercentage(a)+")\x3c/div\x3e");return e+"\x3c/div\x3e"},handleToolTip:function(a,b,c,d,g){var e='\x3cdiv class\x3d"tooltip-div"\x3e';Array.isArray(a)||(a=[a]);this._isVaildValue(a[0].name)&&(e+='\x3cdiv class\x3d"tr"\x3e'+a[0].name+"\x3c/div\x3e");
a.forEach(function(a){e="radar"!==a.seriesType?e+this.generateToolTip(a,b,c,d,g):e+this._handleRadarTooltip(a,c,d,g)}.bind(this));return e+="\x3c/div\x3e"},_handleRadarTooltip:function(a,b,c,d){var g="";(a.value||[]).forEach(function(e,k){g+=this.generateToolTip(a,e,b,c,d[k])}.bind(this));return g},_isVaildValue:function(a){return"%00-"===encodeURI(a)?!1:this._isNotZeroBoolean(a)},_isNotZeroBoolean:function(a){return 0===a?!0:!!a},settingAdvanceOption:function(a,b){b.advanceOption&&("object"===typeof b.advanceOption?
l.mixin(a,b.advanceOption):"function"===typeof b.advanceOption&&b.advanceOption(a));return a},settingColor:function(a,b){b.color&&b.color[0]&&(a.color=b.color);return a},settingToolTip:function(a,b){a.tooltip={};b.confine&&(a.tooltip.confine=!0);if("radar"===b.type)return a.tooltip.trigger="item",a;if(b.axisPointer){if(a.tooltip.trigger="axis","column"===b.type||"bar"===b.type)a.tooltip.axisPointer={type:"shadow",snap:!0}}else a.tooltip.axisPointer={type:""};return a},settingDataZoom:function(a,b,
c){return this.isAxisChart(b)&&b.series&&b.series.length?b.dataZoom&&b.dataZoom.length?a=this._settingDataZoom(b,a,c):(a.dataZoom=[],a):a},_settingDataZoom:function(a,b,c){if(!this.chart)return b;var d=this.chart.getWidth(),g=a.series[0].data.length,e=a.series.length,g=a.stack?g:g*e;if(!g||!d)return b.dataZoom=h,b;var d="bar"!==a.type?window.isRTL?c.left:d-c.left-b.grid.right:c.top,k=20>d/g,f=d/(20*g),f=parseFloat(100*f,10).toFixed(3),f=100<f?100:f,f=0===f?.01:f,h=[],r="bar"===a.type?"yAxisIndex":
"xAxisIndex",h=a.dataZoom.map(l.hitch(this,function(a){a={type:a,start:0,show:k};a[r]=[0];a.end=f;a.showDataShadow=!1;a.realtime=!1;return a}));b.dataZoom=h;return b},mockChartDataWhenNoData:function(a){a&&Array.isArray(a.labels)&&0===a.labels.length&&a.labels.push("");a&&Array.isArray(a.series)&&0<a.series.length&&a.series.forEach(function(a){a&&Array.isArray(a.data)&&0===a.data.length&&a.data.push(0)});return a},settingDefaultGrid:function(a){a.grid=l.clone(this.defultGrid);return a},settingGrid:function(a,
b){if(!this.isAxisChart(b))return a;a.grid.containLabel=b.yAxis&&b.yAxis.show;var c=b.layout;if(!c||!c.length)return a;var d=0,g=0,e=0,k=0,f=1;c.forEach(function(a){a=a.layout&&a.layout.position;if("xAixsName"===name||"yAixsName"===name)f=.7;"t"===a?d+=f:"b"===a?g+=f:"l"===a?e+=f:"r"===a&&(k+=f)}.bind(this));var h=l.clone(this.defultGrid),c=h.top||0,r=h.bottom||0,q=h.left||0,h=h.right||0,c=c+this.unitDistance*d,r=r+this.unitDistance*g,q=q+this.unitDistance*e,h=h+this.unitDistance*k;b.yAxis&&!b.yAxis.show&&
(r+=this.unitDistance);a.grid.top=c;a.grid.bottom=r;a.grid.left=q;a.grid.right=h;a=this._settingxAxisNameGap(a,b);return a=this._settingGridForMarkName(a,b)},_settingGridForMarkName:function(a,b){var c=b.markLine,d=b.markArea,g=[],e=[];c&&c.data&&c.data.length&&c.data.forEach(function(a){this._hasEndPosName(a)&&g.push(a.name+"");this._hasStartPosName(a)&&e.push(a.name+"")}.bind(this));d&&d.data&&d.data.length&&d.data.forEach(function(a){a=a[0];this._hasOutRightAxisName(b.type,a)&&g.push(a.name+"");
this._hasOutLeftAxisName(b.type,a)&&e.push(a.name+"")}.bind(this));if(!g.length&&!e.length)return a;if("bar"===b.type)return a.grid.top+=15,a;c=this._getyAxisLabelWidth(b);d=this._getMaxLengthString(g);d=this.getTextWidth(d,"normal 12px sans-serif");window.isRTL?a.grid.left+=d:a.grid.right+=d;d=this._getMaxLengthString(e);d=this.getTextWidth(d,"normal 12px sans-serif");d-=c;if(0>=d)return a;d+=10;window.isRTL?a.grid.right=d:a.grid.left=d;return a},_getyAxisLabelWidth:function(a){var b=a&&a.yAxis;
return b&&b.show?(a=this._getMaxData(a))||0===a?this.getTextWidth(a,"normal "+(b&&b.textStyle&&b.textStyle.fontSize||12)+"px sans-serif"):0:0},_getMaxData:function(a){if((a=a.series)&&a.length)return a=a.map(function(a){if((a=a.data)&&a.length)return a.map(function(a){var b;"number"===typeof a?b=a:a&&"undefined"!==typeof a.value&&(b=a.value);return b=parseInt(b,10)})}).map(function(a){if(a.length)return Math.max.apply(Math,a)}),a.length&&Math.max.apply(Math,a)},_getMaxLengthString:function(a){return a.sort(function(a,
c){a=this.getTextWidth(a);c=this.getTextWidth(c);return c-a}.bind(this))[0]},_hasOutRightAxisName:function(a,b){var c=b.name||0===b.name;b=b.label;var d=window.isRTL?"eft":"ight";a=b&&b.position&&-1<b.position.indexOf("bar"===a?"op":d);b=b&&b.position&&-1<b.position.indexOf("inside");return c&&a&&!b},_hasOutLeftAxisName:function(a,b){var c=b.name||0===b.name;b=b.label;var d=window.isRTL?"ight":"eft";a=b&&b.position&&-1<b.position.indexOf("bar"===a?"op":d);b=b&&b.position&&-1<b.position.indexOf("inside");
return c&&a&&!b},_hasEndPosName:function(a){var b=a.label,b=!b||!b.position||"end"===b.position;return(a.name||0===a.name)&&b},_hasStartPosName:function(a){var b=a.label,b=!b||!b.position||"start"===b.position;return(a.name||0===a.name)&&b},_settingxAxisNameGap:function(a,b){if(!this.isAxisChart(b)||!a.xAxis)return a;b=this.getHeightByFontSize(b.xAxis&&b.xAxis.textStyle&&b.xAxis.textStyle.fontSize||12);a.xAxis.nameGap=10+b;return a},calcDefaultLayout:function(a){if(this.isBaseChartType(a)){var b=
a.legend,c=a.xAxis,d=null;a=a.type;"pie"!==a&&(d="bar"!==a?{name:"dataZoom",layout:{position:"t",inner:!1}}:{name:"dataZoom",layout:{position:window.isRTL?"l":"r",inner:!1}});a=null;b&&b.show&&(a={name:"legend",layout:{position:"b",inner:!1}});b=null;c&&c.show&&"undefined"!==typeof c.name&&(b={name:"xAxisName",layout:{position:"b",inner:!1}},a&&(b.layout.inner=!0));c=[];a&&c.push(a);d&&c.push(d);b&&c.push(b);return c.length&&c}},settingRenderOption:function(a,b){if("curved"===b.shape)return a.animationThreshold=
99999999,a.hoverLayerThreshold=99999,a.progressiveThreshold=99999,a;a.hoverLayerThreshold=500;a.progressiveThreshold=500;a.progressive=100;a.animationThreshold=500;return a},settingBackgroundColor:function(a,b){b.backgroundColor&&(a.backgroundColor=b.backgroundColor);return a},settingAxisChartAxis:function(a,b){var c=b.xAxis,d=b.yAxis,g={nameLocation:"center"},e={nameLocation:"center"};"column"===b.type||"line"===b.type&&b.labels?(g.data=b.labels,g.type="category",e.type="value"):"bar"===b.type&&
b.labels&&(e.data=b.labels,e.type="category",g.type="value");c&&(g.name=c.name,g.show=!!c.show,c.textStyle&&(g.axisLabel=c.textStyle),c.nameTextStyle&&(g.nameTextStyle=c.nameTextStyle));d&&(e.show=!!d.show,d.textStyle&&(e.axisLabel=d.textStyle));window.isRTL&&(g.inverse=!0,e.position="right");a.xAxis=g;a.yAxis=e;return a},settingRadar:function(a,b){if("radar"!==b.type)return a;a.radar={nameGap:6,radius:"70%"};a.radar.axisLabel={show:!0,formatter:function(){}};b.radarShape&&(a.radar.shape=b.radarShape);
b.indicator?(this._handleRadarIndicator(b),a.radar.indicator=b.indicator):console.error("No radar indicator");return a},_handleRadarIndicator:function(a){var b=a.series[0].data,c=[];a.indicator.forEach(function(a,d){if("undefined"!==typeof a.max)return a;c=b.map(function(a){c.push(a.value[d])});var e=Math.max.apply(Math,c);a.max=e})},settingArea:function(a,b){if("line"!==b.type||!b.area)return a;a.series=a.series.map(function(a){a.areaStyle||(a.areaStyle={});"undefined"===typeof a.areaStyle.opacity&&
(a.areaStyle.opacity=.4);a.sthisoth=!0;a.smoothMonotone="x";return a});return a},_mockNegativeValue:function(a){return a&&a[0]&&a[0].data?a.map(function(a){a.data=a.data.map(function(a,b){var c=0===b%2;a&&"undefined"!==typeof a.value?(b=a.value,b=Number(b),a.value=c?-b:b):(b=Number(a),a=-(c?-b:b));return a});return a}):a},hasNegativeValue:function(a){if((a=a.series)&&a[0]&&a[0].data)return a.some(function(a){return a.data.some(function(a){a=a&&"undefined"!==typeof a.value?a.value:a;a=Number(a);return"number"===
typeof a&&0>a})})},allNegativeValue:function(a){return(a=a.series)&&a[0]&&a[0].data?a.every(function(a){return a.data.every(function(a){a=a&&a.value?a.value:a;a=Number(a);return"number"===typeof a&&0>a})}):!1},settingStack:function(a,b){b=this._stackForPercent(b);if("percent"===b.stack){var c=this.hasNegativeValue(b),d=this.allNegativeValue(b),g=0,e=1;c&&(g=-1,d&&(e=0),"bar"===b.type?(a.xAxis.max=e,a.xAxis.min=g):(a.yAxis.max=e,a.yAxis.min=g))}b.stack&&(a.series=a.series.map(function(a){a.stack="stack";
return a}));return a},_stackForPercent:function(a){if("percent"!==a.stack)return a;var b=[];a.series.forEach(function(a){l.clone(a.data).forEach(function(a,c){b[c]||(b[c]=[]);(a=a&&"undefined"!==typeof a.value?a.value:a)||(a=0);b[c].push(a)})});var c=[];b.forEach(function(a,b){c[b]||(c[b]=0);a.forEach(function(a){c[b]+=Math.abs(a)})});var d=b.map(function(a,b){return a.map(function(a){return 0===c[b]?null:0<=a?Math.abs(a)/c[b]:-Math.abs(a)/c[b]})});a.series=a.series.map(function(a,b){var c=l.clone(a.data),
c=c.map(function(a,c){if(!a)return a;"undefined"!==typeof a.value?a.value=d[c][b]:a=d[c][b];return a});a.data=c;return a});return a},settingLegend:function(a,b){var c=b.legend;if(!c)return a.legend={show:!1},a;var d={show:c.show,type:"scroll",itemHeight:11,orient:"horizontal",pageButtonPosition:"end",pageTextStyle:{color:"#939393"}};c.textStyle&&(d.textStyle=c.textStyle);a.legend=d;return a=this._handleLegendRTL(a,b)},_handleLegendRTL:function(a,b){if(!b.legend)return a;b={};window.isRTL?(b.x="right",
b.pageButtonPosition="start"):(b.x="left",b.pageButtonPosition="end");a.legend=l.mixin(a.legend,b);return a},settingScale:function(a,b){if(!b.scale)return a;if("bar"===b.type)a.xAxis.scale=!0;else if("line"===b.type||"column"===b.type)a.yAxis.scale=!0;return a},pieChartAvoidLegendLabelOverLap:function(a,b){if("pie"!==b.type)return a;var c=b.dataLabel&&b.dataLabel.show?.75:.85;b.legend&&b.legend.show&&(c-=.12);a.series[0].radius[1]=100*c+"%";return a},settingChartLayout:function(a,b){if(!this.isBaseChartType(b))return a;
(b=b.layout)&&b.length&&b.forEach(function(b){this._assigneeLayout(a,b)}.bind(this));return a},avoidAdjoiningColorSameForPie:function(a,b){if("pie"!==b.type||!a.color||2>=a.color.length)return a;a.series&&a.series[0]&&a.series.forEach(l.hitch(this,function(b){var c=b.data.length;0===(c-1)%a.color.length&&(b=b.data[c-1],b.itemStyle||(b.itemStyle={}),b.itemStyle.color||(b.itemStyle.color=a.color[1]))}));return a},_assigneeLayout:function(a,b){var c=b.name;if("xAxisName"!==c&&"yAxisName"!==c){var d=
b.layout;b=this._getOperateObjByProperty(a,c);if(!b)return a;var g=this._getSubPosition(d&&d.subPosition),e=d&&d.position,d=d&&d.inner,k={};"l"===e?k.left=d?this.unitDistance+this.defultGrid.left-5:this.defultGrid.left-5:"r"===e?k.right=d?this.unitDistance+this.defultGrid.right-5:this.defultGrid.right-5:"t"===e?k.top=d?this.defultGrid.top+this.unitDistance-5:this.defultGrid.top-5:"b"===e&&(k.bottom=d?this.unitDistance+this.defultGrid.bottom-5:this.defultGrid.bottom-5);l.mixin(b,k);l.mixin(b,g);this._specialLegend(b,
c,e);this._specialSliderDataZoom(b,c,e);return a}},_getSubPosition:function(a){if("l"===a)return{left:this.defultGrid.left-5,right:"auto"};if("r"===a)return{right:this.defultGrid.right-5,left:"auto"};if("t"===a)return{top:this.defultGrid.top-5,bottom:"auto"};if("b"===a)return{bottom:this.defultGrid.bottom-5,top:"auto"}},_specialLegend:function(a,b,c){"legend"===b&&(a.orient="l"===c||"r"===c?"vertical":"horizontal")},_specialSliderDataZoom:function(a,b,c){"dataZoom"===b&&("l"===c||"r"===c?(a.orient=
"vertical",a.width=15):(a.orient="horizontal",a.height=15))},_getOperateObjByProperty:function(a,b){if("dataZoom"===b)return this._getSliderDataZoom(a);if("legend"===b)return a.legend},_getSliderDataZoom:function(a){var b=null;(a=a.dataZoom)&&a.length&&a.some(function(a){return"slider"===a.type?(b=a,!0):!1});return b},settingAxisSeries:function(a,b){a=this._setTypeToSeries(a,b);a.series=b.series;return a},settingMarks:function(a,b){a=this.settingMarkLine(a,b);return a=this.settingMarkArea(a,b)},settingMarkLine:function(a,
b){(b=b.markLine)&&b.data&&(b.silent=!0,b.data.forEach(function(a){a.label||(a.label={show:!1,position:"end"});"undefined"!==typeof a.name&&(a.label.show=!0,a.label.formatter=a.name)}),a.series[0].markLine=l.clone(b));return a},settingMarkArea:function(a,b){b.markArea&&(this._handleMarkAreaRTL(b.markArea),b.markArea.silent=!0,a.series[0].markArea=b.markArea);return a},_handleMarkAreaRTL:function(a){window.isRTL&&a&&a.data&&a.data.length&&a.data.forEach(function(a){var b=(a=a&&a[0]&&a[0].label)&&a.position;
b&&("left"===b?b="right":"right"===b?b="left":"insideLeft"===b?b="insideRight":"insideRight"===b&&(b="insideLeft"),a.position=b)})},_settingSeriesDataLabel:function(a,b){b=b.dataLabel;if(!b)return a;var c={};c.show=!!b.show;"undefined"!==typeof b.textStyle&&(c.textStyle=b.textStyle);a.series.forEach(function(a){a.label=c});return a},settingRadarSeries:function(a,b){a=this._setTypeToSeries(a,b);a.series=b.series.map(l.hitch(this,function(a){a.data=this._handleSeriesDataForPieLikeType(a,b);return a=
this._settingRaderSerie(a,b)}));return a},_settingRaderSerie:function(a,b){if("radar"!==a.type)return a;var c=b.indicator.map(function(a){return a.name});a.tooltip={};a.tooltip.formatter=function(a){return this.handleToolTip(a,null,!1,!1,c)};return a},settingFunnelSeries:function(a,b){a=this._setTypeToSeries(a,b);a.series=b.series.map(l.hitch(this,function(a){a.data=this._handleSeriesDataForPieLikeType(a,b);return a=this._settingFunnelSerie(a,b)}));return a},_settingFunnelSerie:function(a,b){if("funnel"!==
a.type)return a;a.minSize="0%";a.maxSize="100%";a.sort="descending";a.min=b.min||0;a.max=b.max||100;a.max=b.funnelSort||"descending";return a},settingPieSeries:function(a,b){a=this._setTypeToSeries(a,b);a.series=b.series.map(l.hitch(this,function(a){a.data=this._handleSeriesDataForPieLikeType(a,b);return a=this._settingPieSerie(a,b)}));return a},_settingPieSerie:function(a,b){if("pie"!==a.type)return a;var c=b.dataLabel&&b.dataLabel.show;a.selectedMode="single";a.selectedOffset=10;a.hoverOffset=5;
a.radius=[0,"70%"];a.labelLine={show:!0,length:5,length2:5};a.labelLine.show="undefined"===typeof b.labelLine?!0:b.labelLine;c||(a.labelLine.show=!1);"number"===typeof b.innerRadius&&(0>b.innerRadius&&(b.innerRadius=0),60<b.innerRadius&&(b.innerRadius=60),a.radius[0]=b.innerRadius+"%");"rose"===b.pieMode&&(a.roseType=b.roseType||"radius");return a=this._absoluteValueForPieChart(a)},_absoluteValueForPieChart:function(a){if(!a||!a.data||!a.data[0])return a;a.data=a.data.map(function(a){"number"===typeof a?
a=Math.abs(a):"object"===typeof a&&"number"===typeof a.value&&(a.value=Math.abs(a.value));return a});return a},_handleSeriesDataForPieLikeType:function(a,b){return a.data.map(l.hitch(this,function(a,d){var c={};a||"number"===typeof a?(c.value="undefined"!==typeof a.value?a.value:a,a.itemStyle&&(c.itemStyle||(c.itemStyle={}),c.itemStyle=l.mixin(c.itemStyle,a.itemStyle))):c.value=a;c.name=b.labels[d]||"";return c}))},_setTypeToSeries:function(a,b){var c=b.series;if(!c)return a;c.forEach(function(a){a.type||
(a.type=b.type);a.type="column"===b.type?"bar":b.type});return a},splitAxisStackColumn:function(a,b){var c=a.series;if(!c||!c.length)return a;var d;c.some(function(a){a=a.data;if(!a||!a.length)return!0;a.some(function(a){if(a&&a.itemStyle&&"undefined"!==typeof a.itemStyle.color&&"line"!==b.type)return d=b.stack?"stack":"single",!0;d=!1})});var g=0;"single"===d?g=.1:"stack"===d&&(g=1);var e="";"stack"===d&&(e="#fff",b.backgroundColor&&"transparent"!==b.backgroundColor&&(e=b.backgroundColor));a.series=
a.series.map(function(a){if("bar"===a.type||"pie"===a.type)a.itemStyle||(a.itemStyle={}),a.emphasis||(a.emphasis={}),a.itemStyle.borderWidth=g,a.emphasis.borderWidth=g,e?(a.itemStyle.borderColor=e,a.emphasis.borderColor=e):(a.itemStyle.borderColor="transparent",a.emphasis.borderColor="transparent");return a});return a},preProcessConfig:function(a,b){b.min=b.min||0;b.max=b.max||0;return a},settingLabelColor:function(a,b){var c="#000";b.gaugeOption&&b.gaugeOption.labelColor&&(c=b.gaugeOption.labelColor);
"curved"===b.shape?a.series[0].axisLabel.textStyle.color=c:"horizontal"===b.shape?a.xAxis.axisLabel.textStyle.color=c:"vertical"===b.shape&&(a.yAxis.axisLabel.textStyle.color=c);return a},settingValueStyle:function(a,b){var c=b.gaugeOption&&b.gaugeOption.valueStyle,d=c&&c.textStyle,c=c&&c.formatter;d&&l.mixin("curved"===b.shape?a.series[0].detail.textStyle:a.series[1].data[0].label.textStyle,d);c&&("curved"===b.shape?a.series[0].detail.formatter=c:a.series[1].data[0].label.formatter=c);return a},
settingGaugeColumnColor:function(a,b){var c=b.gaugeOption&&b.gaugeOption.bgColor;b=b.gaugeOption&&b.gaugeOption.columnColor;c&&(a.series[0].itemStyle.color=c);b&&(a.series[1].data[0].itemStyle.color=b);return a},initHorizontalOption:function(a){l.mixin(a,this.horizontal);return a},setHorizontalGrid:function(a){a.grid={top:"middle",height:90,left:"10%",right:"10%"};return a},settingHorizontalAxis:function(a,b){a.xAxis.max=b.max;a.xAxis.min=b.min;a.xAxis.scale=!0;return a},settingHorizontalSeries:function(a,
b){var c=a.series;if(!c||!c.length)return a;var d=c[1];c[0].data[0]=b.max;a=this._handleValueDisplayForColumnGauge(a,b);d.data[0].name=b.labels&&b.labels[0]||"";d.name=b.series[0].name||"";return a},settingHorizontalGaugeRTL:function(a){if(!window.isRTL)return a;a.series[1].label.offset=[-20,0];a.xAxis.inverse=!0;a.yAxis.position="right";return a},initVerticalOption:function(a){l.mixin(a,this.vertical);return a},setVerticalGrid:function(a){a.grid={left:"middle",width:60,top:"10%",bottom:"10%"};a.grid.left=
this._getGridLeftOfVerticalGauge();return a},settingVerticalAxis:function(a,b){a.yAxis.max=b.max;a.yAxis.min=b.min;return a},settingVerticalSeries:function(a,b){var c=a.series;if(!c||!c.length)return a;var d=c[1];c[0].data[0]=b.max;a=this._handleValueDisplayForColumnGauge(a,b);d.data[0].name=b.labels&&b.labels[0]||"";d.name=b.series[0].name||"";return a},settingVerticalGaugeRTL:function(a,b){if(!window.isRTL)return a;var c=(b.series[0].data[0]+"").length-1;b.gaugeOption&&b.gaugeOption.valueStyle&&
"undefined"!==typeof b.gaugeOption.valueStyle.decimalPlaces&&(c+=b.gaugeOption.valueStyle.decimalPlaces);a.series[1].label.offset=[-17-9*c,-15];a.xAxis.inverse=!0;a.yAxis.position="right";return a},initCurvedOption:function(a){a.series=[this.curved];return a},settingCurvedTooltip:function(a){a.tooltip.formatter=function(a){return this.handleToolTip(a,null,!1)}.bind(this);return a},settingCurvedSeries:function(a,b){var c=a.series&&a.series[0];if(!c)return a;c.min=b.min||0;c.max=b.max||1E3;var d=b.series&&
b.series[0]&&b.series[0].data&&b.series[0].data[0];c.data[0].value=d||0;d=d?parseFloat(d/c.max).toFixed(2):0;c.axisLine.lineStyle.color[0][0]=d;if(d=b.labels&&b.labels[0])c.data[0].name=d;c.name=b.series[0]&&b.series[0].name||"";c.axisLine.lineStyle.width=30;a.series=[c];return a},settingCurvedGaugeColor:function(a,b){var c=a.series&&a.series[0];b.gaugeOption&&(b.gaugeOption.bgColor&&(c.axisLine.lineStyle.color[1][1]=b.gaugeOption.bgColor),b.gaugeOption.columnColor&&(c.axisLine.lineStyle.color[0][1]=
b.gaugeOption.columnColor,c.itemStyle.color=b.gaugeOption.columnColor));return a},settingCurvedTargets:function(a,b){if(!a.series)return a;a.series[0].splitNumber=1E3;a.series[0].axisTick.splitNumber=1;a.series[0].axisTick.show=!1;this.targets=this._getTargetValues(b);return a=this._showTargetsForCurved(a,b,this.targets)},createTargetGraphic:function(a){var b=a.shape,c=[];if("vertical"!==b&&"horizontal"!==b)return c;var d="#000";a.gaugeOption&&a.gaugeOption.labelColor&&(d=a.gaugeOption.labelColor);
var g,e=a.min||0,k=a.max||100;a=this._getTargetValues(a);var f=a.range;a.values.forEach(function(a){if(!(a>k||a<e)){g=this._calcGraphicPosition(a,b);var f=g.top,m=g.textLeft,h=this._createGraphic(g.graphicLeft,f,a,d,"image",b);a=this._createGraphic(m,f,a,d,"text",b);c.push(h);c.push(a)}}.bind(this));f.forEach(function(a){a>k||a<e||(g=this._calcGraphicPosition(a,b),a=this._createGraphic(g.textLeft,g.top,a,d,"text",b),c.push(a))}.bind(this));return c},_calcGraphicPosition:function(a,b){var c,d,g;"vertical"===
b?(c=this.chart.convertToPixel({xAxisIndex:0},0),c=parseFloat(c,10).toFixed(2),c=Number(c),window.isRTL&&(c+=40),d=c-26,g=window.isRTL?d+11:d-11-6*(a.toString().length-1),c=this._getyAxisValueTop(a),c-=2):"horizontal"===b&&(c=this.chart.convertToPixel({yAxisIndex:0},0),c=parseInt(c,10),c=Number(c)+16,d=this._getxAxisValueLeft(a),a=6*(a.toString().length-2),g=d,0<a&&(g=d-a));return{top:c,graphicLeft:d,textLeft:g}},_createGraphic:function(a,b,c,d,g,e){var k=this.horIconUrl;"vertical"===e&&(k=window.isRTL?
this.verIconUrlRTL:this.verIconUrl);var m=null;"image"===g?m={z:10,type:"image",$action:"merge",id:"wab_gid_image-"+f.getRandomString(),left:a,style:{image:k,width:10,height:10},silent:!0,top:b}:"text"===g&&(m={z:10,type:"text",$action:"merge",id:"wab_gid_text-"+f.getRandomString(),left:a,style:{text:c,fill:d,font:"normal 11px sans-serif"},silent:!0});"text"===g&&(m.top="vertical"===e?b-2:b+11);return m},updateGridForVerticalGauge:function(a){if("gauge"===a.type&&"vertical"===a.shape)return{left:this._getGridLeftOfVerticalGauge(),
width:60,top:"10%",bottom:"10%"}},_getTargetValues:function(a){var b=a.gaugeOption&&a.gaugeOption.showTargetValueLabel,c=a.gaugeOption&&a.gaugeOption.showDataRangeLabel,d=a.gaugeOption&&a.gaugeOption.targetValue,g=a.min||0;a=a.max||1E3;var e={values:[],range:[]};d&&b&&d.forEach(function(a){e.values.push(a)});c&&(0>e.values.indexOf(g)&&(e.range[0]=g),0>e.values.indexOf(a)&&(e.range[1]=a));return e},_showTargetsForCurved:function(a,b,c){var d=c.values.concat(c.range),g=(b.max-b.min)/1E3;d.sort(function(a,
b){return a-b});a.series[0].axisLabel.formatter=function(a){var b;d.forEach(function(c){"undefined"===typeof b&&c>=a&&c<a+g&&(b=c)});return b};return a},_handleValueDisplayForColumnGauge:function(a,b){var c;c=b.series[0].data[0]<=b.max?b.series[0].data[0]:b.max;a.tooltip.formatter=function(a){return this.handleToolTip(a,b.series[0].data[0],!1)}.bind(this);a.series[1].data[0].value=c;return a},_getGridLeftOfVerticalGauge:function(){return this.chart.getWidth()/2-30},_getxAxisValueLeft:function(a){a=
this.chart.convertToPixel({xAxisIndex:0},a);return parseFloat(a,10)-4},_getyAxisValueTop:function(a){a=this.chart.convertToPixel({yAxisIndex:0},a);return parseFloat(a,10)}})})},"jimu/dijit/_Gauge":function(){define(["dojo/_base/declare"],function(n){return n([],{constructor:function(f){this.chart=f.chart;this.chartUtils=f.chartUtils},produceOption:function(f,h){f=this.chartUtils.preProcessConfig(f,h);"curved"===h.shape?f=this.setCurvedGaugeOption(f,h):"vertical"===h.shape?f=this.setVerticalGaugeOption(f,
h):"horizontal"===h.shape?f=this.setHorizontalGaugeOption(f,h):console.error("invaild gauge shape");f=this.chartUtils.settingLabelColor(f,h);return f=this.chartUtils.settingValueStyle(f,h)},setCurvedGaugeOption:function(f,h){f=this.chartUtils.initCurvedOption(f);f=this.chartUtils.settingCurvedSeries(f,h);f=this.chartUtils.settingCurvedTooltip(f,h);f=this.chartUtils.settingCurvedGaugeColor(f,h);return f=this.chartUtils.settingCurvedTargets(f,h)},setVerticalGaugeOption:function(f,h){f=this.chartUtils.initVerticalOption(f,
this.vertical);f=this.chartUtils.setVerticalGrid(f);f=this.chartUtils.settingVerticalAxis(f,h);f=this.chartUtils.settingVerticalSeries(f,h);f=this.chartUtils.settingGaugeColumnColor(f,h);return f=this.chartUtils.settingVerticalGaugeRTL(f,h)},setHorizontalGaugeOption:function(f,h){f=this.chartUtils.initHorizontalOption(f,this.horizontal);f=this.chartUtils.setHorizontalGrid(f);f=this.chartUtils.settingHorizontalAxis(f,h);f=this.chartUtils.settingHorizontalSeries(f,h);f=this.chartUtils.settingGaugeColumnColor(f,
h);return f=this.chartUtils.settingHorizontalGaugeRTL(f,h)},resetGraphic:function(f){if("horizontal"===f.shape||"vertical"===f.shape)f=this.chartUtils.createTargetGraphic(f),this.clearGraphic(),this.chart.setOption({graphic:f}),this.cacheGraphic=null,this.cacheGraphic=f},clearGraphic:function(){this.cacheGraphic&&(this.cacheGraphic.forEach(function(f){f.$action="remove"}),this.chart.setOption({graphic:this.cacheGraphic}))},resetGrid:function(f){("horizontal"===f.shape||"vertical"===f.shape)&&(f=this.chartUtils.updateGridForVerticalGauge(f))&&
this.chart.setOption({grid:f})}})})},"jimu/dijit/_ChartOptionFactory":function(){define(["dojo/_base/declare"],function(n){return n([],{constructor:function(f){this.chart=f.chart;this.gauge=f.gauge;this.chartUtils=f.chartUtils},produceOption:function(f){if(f&&f.type){var h=f.type,l={},l=this.setCommonOption(l,f);this.chartUtils.isAxisChart(f)?l=this.setAxisChartOption(l,f):"pie"===h?l=this.setPieChartOption(l,f):"funnel"===h?l=this.setFunnelChartOption(l,f):"radar"===h?l=this.setRadarChartOption(l,
f):f.shape&&(l=this.setGaugeChartOption(l,f));return l=this.chartUtils.settingAdvanceOption(l,f)}},setPieChartOption:function(f,h){f=this.chartUtils.settingPieSeries(f,h);f=this.chartUtils._settingSeriesDataLabel(f,h);f=this.chartUtils.pieChartAvoidLegendLabelOverLap(f,h);return f=this.chartUtils.avoidAdjoiningColorSameForPie(f,h)},setGaugeChartOption:function(f,h){return f=this.gauge.produceOption(f,h)},setFunnelChartOption:function(f,h){return f=this.chartUtils.settingFunnelSeries(f,h)},setRadarChartOption:function(f,
h){f=this.chartUtils.settingRadar(f,h);return f=this.chartUtils.settingRadarSeries(f,h)},setAxisChartOption:function(f,h){f=this.chartUtils.settingDefaultGrid(f,h);f=this.chartUtils.settingAxisChartAxis(f,h);f=this.chartUtils.settingAxisSeries(f,h);f=this.chartUtils.settingMarks(f,h);f=this.chartUtils._settingSeriesDataLabel(f,h);f=this.chartUtils.splitAxisStackColumn(f,h);f=this.chartUtils.settingStack(f,h);f=this.chartUtils.settingArea(f,h);return f=this.chartUtils.settingScale(f,h)},setCommonOption:function(f,
h){this.chart._theme||(this.chart._theme={});f=this.chartUtils.settingRenderOption(f,h);f=this.chartUtils.settingBackgroundColor(f,h);f=this.chartUtils.settingColor(f,h);f=this.chartUtils.settingToolTip(f,h);return f=this.chartUtils.settingLegend(f,h)}})})},"libs/echarts/light":function(){(function(n,f){"function"===typeof define&&define.amd?define(["exports","./echarts"],f):"object"===typeof exports&&"string"!==typeof exports.nodeName?f(exports,require("./echarts")):f({},n.echarts)})(this,function(n,
f){f?f.registerTheme("light",{color:"#2ec7c9 #b6a2de #5ab1ef #ffb980 #d87a80 #8d98b3 #e5cf0d #97b552 #95706d #dc69aa #07a2a4 #9a7fd1 #588dd5 #f5994e #c05050 #59678c #c9ab00 #7eb00a #6f5553 #c14089".split(" "),textStyle:{},title:{textStyle:{color:"#008acd"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"6",symbol:"circle",smooth:!1},gauge:{axisLine:{lineStyle:{color:[[.31,
"#58f7f3"],[1,"#E5E5E5"]]}},itemStyle:{normal:{color:"#686868"},emphasis:{color:"#686868"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},
axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#2ec7c9"},emphasis:{borderColor:"#18a4a6"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#008acd",width:"1"},crossStyle:{color:"#008acd",width:"1"}}},dataZoom:{backgroundColor:"#F4F4F4",dataBackgroundColor:"rgba(47,69,84,0.3)",
fillerColor:"#E0E0E0",handleColor:"#777777",handleSize:"100%",borderColor:"#F4F4F4",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"libs/echarts/dark":function(){(function(n,f){"function"===typeof define&&define.amd?define(["exports","./echarts"],f):"object"===typeof exports&&"string"!==typeof exports.nodeName?f(exports,require("./echarts")):f({},n.echarts)})(this,function(n,f){f?f.registerTheme("dark",{color:"#fc97af #87f7cf #f7f494 #72ccff #f7c5a0 #d4a4eb #d2f5a6 #76f2f2".split(" "),
textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#1E5F6F"]]}},itemStyle:{normal:{color:"#D9D9D9"},emphasis:{color:"#D9D9D9"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},
axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)",
"rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},dataZoom:{backgroundColor:"#525252",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#737373",handleColor:"#BDBDBD",handleSize:"100%",borderColor:"#525252",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},
"widgets/Infographic/utils":function(){define("dojo/on jimu/utils jimu/DataSourceManager jimu/statisticsUtils dojo/_base/lang dojo/_base/Color dojo/_base/array dojo/Deferred esri/layers/FeatureLayer".split(" "),function(n,f,h,l,d,a,b,c,m){return{getClientFeaturesFromMap:function(a,b,c,d){return f.getClientFeaturesFromMap(a,b,c,d)},listenClientFeaturesFromMap:function(a,c,f,m,h){var e=[];f&&(e.push(n(c,"selection-complete",d.hitch(this,function(){h(this.getClientFeaturesFromMap(a,c,f,m))}))),e.push(n(c,
"selection-clear",d.hitch(this,function(){h(this.getClientFeaturesFromMap(a,c,f,m))}))));m&&e.push(n(a,"extent-change",d.hitch(this,function(){0<c.graphics.length&&h(this.getClientFeaturesFromMap(a,c,f,m))})));e.push(n(c,"update-end",d.hitch(this,function(){h(this.getClientFeaturesFromMap(a,c,f,m))})));h(this.getClientFeaturesFromMap(a,c,f,m));return{remove:function(){e&&b.forEach(e,d.hitch(this,function(a){a.remove()}));e=null}}},getVaildIndicator:function(a,b,c){var e=[];b.map(d.hitch(this,function(b){(b=
this._handleOperator(b,a,c))&&e.push(b)}));if(0<e.length)return e[e.length-1]},getSingleValueFromFeatures:function(a,c,d){if(!d||!d.length)return null;var e=h.getInstance(),g=0;if("Features"===a.type){if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===c.dataSourceType||"Features"===e.getDataSourceConfig(c.frameWorkDsId).type)return d.length;g=0;b.forEach(d,function(a){var b=a.attributes.STAT_COUNT;"undefined"===typeof b&&(b=a.attributes.stat_count);g+=b});return g}if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===
c.dataSourceType||"Features"===e.getDataSourceConfig(c.frameWorkDsId).type)return this._getStatsFromFeatures(d,a.fieldName,a.statisticsType);var k=0,m=0,g=0,l=f.upperCaseString(a.fieldName+"_"+a.statisticsType);b.forEach(d,function(b){var c=b.attributes[l];"undefined"===typeof c&&(l=f.lowerCaseString(a.fieldName+"_"+a.statisticsType),c=b.attributes[l]);switch(a.statisticsType){case "sum":k+=c;break;case "min":k=Math.min(k,c);break;case "max":k=Math.max(k,c);break;case "avg":b=this._getSumCountValue(a.fieldName,
b.attributes),m+=b.sum,g+=b.count}}.bind(this));"avg"===a.statisticsType&&(k=0===g?0:m/g);return k},_getSumCountValue:function(a,b){var c;c=f.upperCaseString(a+"_SUM");c=b[c];"undefined"===typeof c&&(c=f.lowerCaseString(a+"_SUM"),c=b[c]);a=b.STAT_COUNT;"undefined"===typeof a&&(a=f.lowerCaseString("STAT_COUNT"),a=b[a]);return{sum:c||0,count:a||0}},filterFeaturesByDataSourceSetting:function(a,c,d){if(0===a.length)return[];if(c.useSelection){var e=a[0].getLayer();if(e){var g=e.getSelectedFeatures();
0<g.length&&(a=b.filter(a,function(a){return-1<g.indexOf(a)}))}}c.filterByExtent&&(a=f.filterFeaturesByExtent(d.extent,a));return a},_getStatsFromFeatures:function(a,b,c){return l.getStatisticsResultFromClientSync({featureSet:{features:a},fieldName:b,statisticTypes:[c]})[c+"Field"]},_handleOperator:function(a,b,c){function e(a){g={};a.valueColor&&(g.valueColor=a.valueColor);a.gaugeColor&&(g.gaugeColor=a.gaugeColor);a.iconInfo&&(g.iconInfo=a.iconInfo)}var g,f=a.value.map(d.hitch(this,function(b){return a.isRatio?
b/100*c:b}));"greater"===a.operator&&b>f[0]?e(a):"smaller"===a.operator&&b<f[0]?e(a):"between"===a.operator&&b>f[0]&&b<f[1]?e(a):"equal"===a.operator&&b===f[0]?e(a):"notEqual"===a.operator&&b!==f[0]&&e(a);return g},isInteger:function(a){return"number"===typeof a&&0===a%1},checkDataSourceIsVaild:function(a,b,c,d){var e={code:0,fields:[]},g=null;a?"DATA_SOURCE_FROM_FRAMEWORK"===a.dataSourceType?d&&d.dataSource&&d.dataSource.dataSources?(c=d.dataSource.dataSources[a.frameWorkDsId])?(g=c.dataSchema&&
c.dataSchema.fields,e=this._isDataSourceContainNeededFields(g,b,e)):e.code=1:e.code=1:"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===a.dataSourceType&&((a=a.layerId)&&c?(c=c.getLayer(a))?(g=c.fields,e=this._isDataSourceContainNeededFields(g,b,e)):e.code=1:e.code=1):e.code=1;return e},_isDataSourceContainNeededFields:function(a,b,c){if(!a||!a.length)return c.code=1,c;var e=this._getFieldNamesByFields(a);a=this._getNeededFieldsByMainDijitJson(b);if(!a||!a.length)return c.code=0,c;a.forEach(function(a){0>e.indexOf(a)&&
c.fields.push(a)});c.fields.length&&(c.code=2);return c},_getNeededFieldsByMainDijitJson:function(a){if(a)return this._getNeededFieldsByDijitConfig(a.type,a.config)},_getNeededFieldsByDijitConfig:function(a,b){var c=null;if(b){if("chart"===a)c=[],b.labelField&&c.push(b.labelField),b.categoryField&&c.push(b.categoryField),b.valueFields&&b.valueFields.length&&(c=c.concat(b.valueFields));else if("gauge"===a||"number"===a)c=[],(a=b.statistic)&&(a=a.fieldName)&&c.push(a);if(c&&c.length)return c}},_getFieldNamesByFields:function(a){if(a&&
a.length)return a.map(function(a){return this._getFieldNameByFieldInfo(a)}.bind(this))},_getFieldNameByFieldInfo:function(a){return a&&a.name},isBaseAxisChart:function(a){return"column"===a||"bar"===a||"line"===a},isEqual:function(a,b){return typeof a!==typeof b?!1:"object"!==typeof a?a===b:f.isEqual(a,b)},separationChartProperties:function(a){var b=a.type;a=a.mode;var c=["mode","type"],d=["backgroundColor","seriesStyle","legend","highLightColor"];"feature"===a?c=c.concat(["labelField","valueFields"]):
"category"===a?c=c.concat(["categoryField","dateConfig","valueFields","operation","nullValue"]):"count"===a?c=c.concat(["categoryField","dateConfig"]):"field"===a&&(c=c.concat(["valueFields","operation","nullValue"]));c=c.concat(["sortOrder","maxLabels"]);d="pie"===b?d.concat(["dataLabel","innerRadius"]):d.concat(["xAxis","yAxis","stack","area","marks"]);return{dataProperties:c,displayProperties:d}},classifyChartConfig:function(a){if(a){var b=this.separationChartProperties(a),c=b.displayProperties,
g={},f={};b.dataProperties.forEach(d.hitch(this,function(b){g[b]=a[b]}));c.forEach(d.hitch(this,function(b){f[b]=a[b]}));return{data:g,display:f}}},getCleanChartConfig:function(a){var b={mode:a.mode,type:a.type},c=this.separationChartProperties(a),g=c&&c.dataProperties,c=c&&c.displayProperties;g&&g.length&&g.forEach(d.hitch(this,function(c){b[c]=a[c]}));c&&c.length&&c.forEach(d.hitch(this,function(c){b[c]=a[c]}));return!b.mode||!("count"===b.mode||b.valueFields&&b.valueFields.length)||"pie"===b.type&&
""===b.maxLabels?null:d.clone(b)},_cloneAndFormatDS:function(a){a=d.clone(a);var b={};a.name&&(b.name=a.name);a.dataSourceType&&(b.dataSourceType=a.dataSourceType);a.layerId&&(b.layerId=a.layerId);a.frameWorkDsId&&(b.frameWorkDsId=a.frameWorkDsId);a=null;return b},isDSEqual:function(a,b){if(a&&b)return a=this._cloneAndFormatDS(a),b=this._cloneAndFormatDS(b),this.isEqual(a,b)},separationGradientColors:function(a,b){var c=[];2===a.length&&(c=this._createGradientColors(a[0],a[a.length-1],b));return c},
_createGradientColors:function(b,c,d){var e=[];b=new a(b);var f=new a(c);c=(f.r-b.r)/d;for(var g=(f.g-b.g)/d,f=(f.b-b.b)/d,k=new a,m=0,h=0,l=0,u=0;u<d;u++)m=parseInt(b.r+c*u,10),h=parseInt(b.g+g*u,10),l=parseInt(b.b+f*u,10),k.setColor([m,h,l]),e.push(k.toHex());return e},mockLayerDefinitionForSTD:function(a){var b={type:"Table",fields:[]};b.fields=a.fields;b.fields.push({name:"STAT_COUNT",type:"esriFieldTypeInteger",alias:"STAT_COUNT"});return b},getLoadedLayer:function(a){var b=new c,f=null,f="string"===
typeof a?new m(a):"esri.layers.FeatureLayer"===a.declaredClass?a:new m({layerDefinition:d.clone(a),featureSet:null});if(f.loaded)b.resolve(f);else f.on("load",function(){b.resolve(f)});return b},parseDataSourceId:function(a){var b=a.split("~"),c={};if(2>b.length)return console.error("Bad data source id:",a),c;switch(b[0]){case "map":return b=a.lastIndexOf("~"),c={from:"map",layerId:a.substring(4,b)};case "widget":return c={from:"widget",widgetId:b[1]};case "external":return c={from:"external"};default:console.error("Bad data source id:",
a)}},getDsTypeInfoMeta:function(a,b){var c={dsTypeInfo:null,dsMeta:null};c.dsTypeInfo=this.parseDataSourceId(a);if(b=b.dataSource&&b.dataSource.dataSources)c.dsMeta=b[a];return c},getValueFromFeatures:function(a,b,c){if(!a||!b||!c)return!1;a=this.getSingleValueFromFeatures(a,b,c);a=this._getVaildValue(a);return"number"!==typeof a?!1:a},_getVaildValue:function(a){if(a||0===a)return Number(a)},cleanFeatures:function(a){if(a&&a.length)return a.map(function(a){return{attributes:a.attributes}})},getFieldAliasByFieldInfo:function(a,
b){var c="";if(!a)return c;var d=a.name,c=a.alias||d;b&&(c=this.getAliasFromPopupInfo(d,b));return c},getAliasFromPopupInfo:function(a,b){var c=a;if(!b)return c;(b=b.fieldInfos)&&0<b.length&&b.forEach(function(b){b.fieldName===a&&(c=b.label)});return c}}})},"widgets/Infographic/dijits/GaugeDijit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html ./BaseDijit jimu/utils jimu/dijit/Chart ../utils".split(" "),function(n,f,h,l,d,a,b){return n([l],{templateString:'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"noDataDiv"class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\x3cdiv class\x3d"gauge-dom" data-dojo-attach-point\x3d"gaugeDomNode"\x3e\x3c/div\x3e\x3c/div\x3e',
type:"gauge",baseClass:"infographic-gauge-dijit",config:null,defValueStyle:{state:!0,isRatio:!1,font:{font:{fontFamily:"Arial",bold:!1,italic:!1,underline:!1},textColor:"#59bad8"},dataFormat:{unit:"none",decimalPlaces:"",prefix:"",suffix:""}},constructor:function(a){this.visible=a.visible},postCreate:function(){this.inherited(arguments);this._features=[];this.setConfig(this.config);this._updateBackGroundColor()},setLayerInfo:function(){},setVisible:function(a){this.visible=a},onDataSourceDataUpdate:function(a){this.inSettingPage?
a&&"undefined"!==typeof a.features&&(this._features=b.cleanFeatures(a.features)):"number"===typeof a&&(this._value=a)},resize:function(){this.chart&&this.chart.resize()},setDataSource:function(a){this.inherited(arguments);this.dataSource=a},setConfig:function(a){a&&(this.config=a)},startRendering:function(){if(this._shouldRenderGauge())if(this.chart||this._createJimuChart(),this._updateBackGroundColor(),this._calculateGaugeValue(),"number"!==typeof this.gaugeValue)this.showNodata();else{var a=this._createChartOption();
this.chart.updateConfig(a)}},_calculateGaugeValue:function(){var a;a=this.inSettingPage?b.getValueFromFeatures(this.config&&this.config.statistic,this.dataSource,this._features):this._value;"undefined"!==typeof a&&!1!==a&&(this.gaugeValue=a)},_createChartOption:function(){var a=this.config,b={series:[{data:[this.gaugeValue]}]};b.shape=a.shape;b.type="gauge";b.theme=this.isDarkTheme()?"dark":"light";var d=this._createGaugeOption();b.gaugeOption=d;d=a.min||0;b.max=a.max||1E3;b.min=d;return b},_createGaugeOption:function(){var a=
this.gaugeValue,b=this.config,d={},e=this._getValueStyle();e&&(d.valueStyle=e);this._setGaugeDisplay(d);a=this._getIndicatorInfo(b,a);a.targetValue&&(b=this._isShowTargetValue(),d.targetValue=b?a.targetValue:[]);a.columnColor&&(d.columnColor=a.columnColor);return d},_getIndicatorInfo:function(a,f){var c=!1,e=!1,k=!1,h=this._getIndicatorValues(a);d.isNotEmptyObject(h,!0)&&(c=h);if(h=a.indicators)(a=b.getVaildIndicator(f,h,a.max))&&a.gaugeColor&&(e=a.gaugeColor),a&&a.valueColor&&(k=a.valueColor);return{targetValue:c,
columnColor:e,valueColor:k}},_getIndicatorValues:function(a){var b=[];a.indicators&&(a.indicators.forEach(function(c){c.value&&c.value.forEach(f.hitch(this,function(d){b.push(c.isRatio?d/100*a.max:d)}))}),b.sort(function(a,b){return a-b}),b=d.uniqueArray(b));return b},_shouldRenderGauge:function(){if(this.visible&&this.config){var a;(a=this.inSettingPage?this.domNode&&this._features:this.domNode&&"number"===typeof this._value)?this.hideNodata():this.showNodata();return!!a}},_updateBackGroundColor:function(){var a=
this.config;(a=a&&a.display&&a.display.backgroundColor)&&h.setStyle(this.domNode,"backgroundColor",a)},_createJimuChart:function(){var b=this._getDefaultChartOption();this.chart=new a({chartDom:this.gaugeDomNode,config:b});this.chart.placeAt(this.gaugeDomNode);this.chart.resize()},_generateValueFormatter:function(a){var b=this.config.max||1E3;if(a)return f.hitch(this,function(a,c){var e,f="",g,h=a.dataFormat;if(!h)return c;if((g=h.decimalPlaces)||0===g)g=Number(g);e=a.isRatio?d.convertNumberToPercentage(c/
b,g):c;a.isRatio||("percentage"===h.unit?e=d.convertNumberToPercentage(c,g):"thousand"===h.unit?(f=this.nls.thousandAbbreviation,e/=1E3):"million"===h.unit?(f=this.nls.millionAbbreviation,e/=1E6):"billion"===h.unit&&(f=this.nls.billionAbbreviation,e/=1E9));a.isRatio||"percentage"===h.unit||"number"!==typeof g||(e=e.toFixed(g));f&&(e+=f);a=e;h.prefix&&(a=h.prefix+" "+a);h.suffix&&(a+=" "+h.suffix);return a},a,this.gaugeValue)},_getVaildDecimalPlaces:function(a){if((a=(a=a.dataFormat)&&a.decimalPlaces)||
0===a)a=Number(a);if("number"===typeof a)return a},_getVaildValueDisplay:function(){var a=this.config;if(a=a&&a.display)return a.currentValue&&a.currentValue.state?a.currentValue:f.clone(this.defValueStyle)},_generateTextStyle:function(a){var b=this._getIndicatorInfo(this.config,this.gaugeValue),c=a&&a.font;if(c){a={};"undefined"!==typeof c.fontSize&&(a.fontSize=Number(c.fontSize));a.color=b.valueColor||c.textColor;b=c.font;if(!b)return a;a.fontWeight=b.bold?"bold":"normal";b.fontFamily&&(a.fontFamily=
b.fontFamily);a.fontStyle=b.italic?"italic":"normal";return a}},_isShowTargetValue:function(){var a=this.config&&this.config.display&&this.config.display.dataLabels;if(a)return!!a.targetValue},_setGaugeDisplay:function(a){var b=this.config.display;b&&(b.gaugeColor&&(a.columnColor=b.gaugeColor),b.bgColor&&(a.bgColor=b.bgColor),b.dataLabels&&b.dataLabels.state&&(b=b.dataLabels,a.showDataRangeLabel=!!b.dataRange,a.showTargetValueLabel=!!b.targetValue,a.labelColor=b.textColor||""))},_getValueStyle:function(){var a=
this._getVaildValueDisplay();if(a){var b={},d=this._getVaildDecimalPlaces(a);"number"===typeof d&&(b.decimalPlaces=d);b.formatter=this._generateValueFormatter(a);if(a=this._generateTextStyle(a))b.textStyle=a;return b}},_getDefaultChartOption:function(){var a={type:"gauge",confine:!0,shape:"curved",min:0,max:100,series:[{data:[0]}]};this.config&&this.config.shape&&(a.shape=this.config.shape);a.theme=this.isDarkTheme()?"dark":"light";return a},showNodata:function(a){this.chart&&this.chart.clear();h.addClass(this.domNode,
"no-data");a&&(this.noDataDiv.innerHTML=a)},hideNodata:function(){h.removeClass(this.domNode,"no-data")}})})},"widgets/Infographic/dijits/NumberDijit":function(){define("dojo/_base/declare ./BaseDijit dojo/dom-style dojo/_base/html jimu/utils ../utils ./styleUtils".split(" "),function(n,f,h,l,d,a,b){return n([f],{templateString:'\x3cdiv style\x3d"height:100%;width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"noDataDiv"class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\x3ca data-dojo-attach-point\x3d"numberContent" class\x3d"number-content no-trim" target\x3d"_blank"\x3e\x3cdiv data-dojo-attach-point\x3d"leftIcon" class\x3d"icon"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"number" class\x3d"number"\x3e\x3cdiv data-dojo-attach-point\x3d"prefix" class\x3d"prefix"\x3e\x3c/div\x3e\x3cdiv class\x3d"value-content" data-dojo-attach-point\x3d"valueContent"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"suffix" class\x3d"suffix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"rightIcon" class\x3d"icon"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e',
baseClass:"infographic-number-dijit",type:"number",config:null,constructor:function(a){this.visible=a.visible},postCreate:function(){this.inherited(arguments);this._value=this._features=null;this.setConfig(this.config);this._updateBackGroundColor()},setLayerInfo:function(){},setVisible:function(a){this.visible=a},onDataSourceDataUpdate:function(b){this.inSettingPage?b&&"undefined"!==typeof b.features&&(this._features=a.cleanFeatures(b.features)):"number"===typeof b&&(this._value=b)},setDataSource:function(a){this.inherited(arguments);
this.dataSource=a},setConfig:function(a){a&&(this.config=a)},startRendering:function(){this._shouldRenderNumber()&&(this._updateBackGroundColor(),this._calculateNumberValue(),"number"!==typeof this.numberValue?this.showNodata():this._renderNumber(this.numberValue))},_calculateNumberValue:function(){var b;b=this.inSettingPage?a.getValueFromFeatures(this.config&&this.config.statistic,this.dataSource,this._features):this._value;"undefined"!==typeof b&&!1!==b&&(this.numberValue=b)},_renderNumber:function(a){this._cleanNumberContent();
this.valueContent.innerHTML=d.localizeNumber(a);this._setValueDisplay()},_setValueDisplay:function(){var a=this.config;a&&(this._setBackground(a),this._setFont(a),this._setDataFormat(a),this._setIndicatorStyle())},_shouldRenderNumber:function(){if(this.visible&&this.config){var a;(a=this.inSettingPage?this.domNode&&this._features:this.domNode&&"number"===typeof this._value)?this.hideNodata():this.showNodata();return!!a}},_getIndicatorColor:function(){var b=!1,f=!1,g=this.config.indicators;g&&((g=
a.getVaildIndicator(this.numberValue,g))&&g.valueColor&&(b=g.valueColor),g&&d.isNotEmptyObject(g.iconInfo)&&(f=g.iconInfo));return{color:b,icon:f}},_cleanNumberContent:function(){l.removeClass(this.leftIcon);l.addClass(this.leftIcon,["icon"]);l.removeClass(this.rightIcon);l.addClass(this.rightIcon,["icon"]);this.replaceIcon&&(l.destroy(this.replaceIcon),this.replaceIcon=null);l.empty(this.valueContent);l.empty(this.prefix);l.empty(this.suffix);this._setValueColor("")},_updateBackGroundColor:function(){var a=
this.config;(a=a&&a.background&&a.background.backgroundColor)&&l.setStyle(this.domNode,"backgroundColor",a)},_setBackground:function(a){if(a=a&&a.background){a.backgroundColor&&l.setStyle(this.domNode,"backgroundColor",a.backgroundColor);var b=a.alignment;b&&(l.removeClass(this.domNode),l.addClass(this.domNode,"infographic-number-dijit"),b.horizontal&&l.addClass(this.domNode,"horizontal-"+b.horizontal),b.vertical&&l.addClass(this.domNode,"vertical-"+b.vertical));a.link?l.setAttr(this.numberContent,
"href",a.link):l.removeAttr(this.numberContent,"href")}},_setFont:function(a){if(a&&a.font){var c={};b.font.setStyle(a.font,c);l.setStyle(this.number,c)}},_setDataFormat:function(a){var b,c="";b=this.numberValue;var e=a.dataFormat;if(e){if((a=e.decimalPlaces)||0===a)a=Number(a);"percentage"===e.unit?b=d.convertNumberToPercentage(b,a):"thousand"===e.unit?(c=this.nls.thousandAbbreviation,b/=1E3):"million"===e.unit?(c=this.nls.millionAbbreviation,b/=1E6):"billion"===e.unit&&(c=this.nls.billionAbbreviation,
b/=1E9);"percentage"!==e.unit&&("number"===typeof a&&(b=b.toFixed(a)),b=d.localizeNumber(b));c&&(b+=c);this.valueContent.innerHTML=b;e.prefix&&(this.prefix.innerHTML=e.prefix);e.suffix&&(this.suffix.innerHTML=e.suffix)}},_setIndicatorStyle:function(){var a=this._getIndicatorColor();a.color&&this._setValueColor(a.color);a.icon&&this._setIndicatorIcon(a.icon)},_setValueColor:function(a){h.set(this.number,"color",a)},_setIndicatorIcon:function(a){a&&("left"===a.placement||"right"===a.placement?this._setLeftRightIcon(a):
"replace"===a.placement&&this._setReplaceIcon(a))},_setReplaceIcon:function(a){var b=l.create("div",{"class":"indicator-icon "+a.icon});l.empty(this.valueContent);l.place(b,this.valueContent);h.set(b,"color",a.color);h.set(b,"display","inline-flex")},_setLeftRightIcon:function(a){var b;"left"===a.placement?b=this.leftIcon:"right"===a.placement&&(b=this.rightIcon);l.addClass(b,"indicator-icon "+a.icon);h.set(b,"color",a.color)},showNodata:function(a){this._cleanNumberContent();l.addClass(this.domNode,
"no-data");a&&(this.noDataDiv.innerHTML=a)},hideNodata:function(){l.removeClass(this.domNode,"no-data")}})})},"widgets/Infographic/dijits/SourceLauncher":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/on dojo/Deferred dijit/_WidgetBase ../utils jimu/utils jimu/LayerInfos/LayerInfos jimu/DataSourceManager esri/geometry/geometryEngine esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition esri/layers/FeatureLayer".split(" "),function(n,f,h,l,d,a,b,c,m,g,e,k,p,
t,r){return n([a,h],{oidFieldType:"esriFieldTypeOID",constructor:function(a){this.map=a.map;this.appConfig=a.appConfig;this.useSelection=a.useSelection;this.filterByExtent=a.filterByExtent;this.dijit=a.dijit;this.dataSource=a.dataSource;this.layerInfosObj=m.getInstanceSync();this.dataSourceManager=g.getInstance();this.layerObject=a.layerObject;this._layerUrl=null;this.dijit&&(this.config=this.dijit.config)&&(this.isDateType=!!this.config.dateConfig);"DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType&&
(this.frameWorkDsId=this.dataSource.frameWorkDsId);this.exdsBeginUpdateHandle=this.timeIntervalHandle=this.filterChangedHandle=this.updateEndHandle=this.refreshIntervalHandle=this.selectionHandle=this.exchetChangeHandle=this._oldQueryParameter=this._queryParameter=null},start:function(){this._isExtralStatDataSource();this._tryGetLayerObject().then(function(){this._onFetchSuccess();this.awake();this._listenEventsContinuousAccessFeatures()}.bind(this),function(a){this._onFetchField(a)}.bind(this))},
awake:function(){this.sleeping=!1;this._getFeaturesForFirst()},sleep:function(){this.sleeping=!0},destroy:function(){this._removeHandles();this.inherited(arguments)},setAppConfigDSFeatures:function(a){this.sleeping||"DATA_SOURCE_FROM_FRAMEWORK"!==this.dataSource.dataSourceType||(this._onFetchSuccess(),this._onDataUpdate(a,this._isExtralStatDS))},_getFeaturesForFirst:function(){if("DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType){var a=this.dataSourceManager.getData(this.dataSource.frameWorkDsId);
this._onDataUpdate(a&&a.features,this._isExtralStatDS)}else"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===this.dataSource.dataSourceType&&this._trigerCallback()},_listenEventsContinuousAccessFeatures:function(){if("DATA_SOURCE_FROM_FRAMEWORK"===this.dataSource.dataSourceType)this._resetExdsBeginUpdateHandle(),this.exdsBeginUpdateHandle=l(this.dataSourceManager,"begin-update",f.hitch(this,function(a){a===this.frameWorkDsId&&this._onFetch()}));else if(this.layerObject&&this.layerInfo){var a=this._shouldAccessClientFeatures();
this.useSelection&&(this._resetSelectionHandle(),this.selectionHandle=l(this.layerObject,"selection-complete,selection-clear",f.hitch(this,function(){this._trigerCallback()})));a||(this._resetFilterChangedHandle(),this.filterChangedHandle=l(this.layerInfo,"filterChanged",f.hitch(this,function(){this._trigerCallback()})));a&&(this._resetUpdateEndHandle(),this.updateEndHandle=l(this.layerObject,"update-end",f.hitch(this,function(){this._trigerCallback()})));this.filterByExtent&&this.map&&(this._resetExtentChangeHandle(),
this.exchetChangeHandle=l(this.map,"extent-change",f.hitch(this,function(){this._trigerCallback(!0)})));a||(this._setTimeListener(),this._resetRefreshIntervalHandle(),this.refreshIntervalHandle=l(this.layerObject,"refresh-interval-change",f.hitch(this,this._setTimeListener)))}},_setTimeListener:function(){var a=this._getLayerRefreshInterval();a?(this._resetTimeIntervalHandle(),this.timeIntervalHandle=setInterval(f.hitch(this,function(){this._trigerCallback()}),6E4*a)):this._resetTimeIntervalHandle()},
_trigerCallback:function(a){var b=this.computingTheWayToGetFeatures();if(!a||2!==b||!this._isLayerOnDemandMode())switch(b){case 1:this._getFeaturesFromSelection(this.map,this.layerObject,this.filterByExtent,f.hitch(this,this._onDataUpdate));break;case 2:this._getClientFeaturesFromMap(this.map,this.layerObject,this.filterByExtent,f.hitch(this,this._onDataUpdate));break;case 3:this._getStatisticsFeaturesForServer(f.hitch(this,this._onDataUpdate))}},computingTheWayToGetFeatures:function(){var a=0;return this.sleeping||
!this.layerObject?a:a=this._isMapLayer()?this._shouldAccessFeaturesBySelection()?1:this._shouldAccessClientFeatures()?2:3:0},_getClientFeaturesFromMap:function(a,b,c,d){var e=b.graphics;c&&(e=this._filterFeaturesByExtent(a.extent,e));e=this._sortClientFeaturesByObjID(e,b);d(e)},_getFeaturesFromSelection:function(a,b,c,d){var e=[],f=!1,e=b.getSelectedFeatures(),f=!0;c&&(e=this._filterFeaturesByExtent(a.extent,e));e.isSelectedFeatures=f;e=this._sortClientFeaturesByObjID(e,b);d(e)},_getStatisticsFeaturesForServer:function(a){this._updateLayerInfoFilter();
this._tryGenerateQueryParameter();this._shouldLaunchQuery()&&(this._onFetch(),this.queryDeferred=this._doQuery(),this.queryDeferred.then(f.hitch(this,function(b){this.queryDeferred=null;this._onFetchSuccess();b=b.features||[];b=this._calculateAverageWithNullValueAsZero(b);a(b,!0)}),f.hitch(this,function(a){this.queryDeferred=null;this._onFetchField(a)})))},_updateLayerInfoFilter:function(){if(this.dataSource&&"undefined"!==typeof this.dataSource.layerId){var a=this.layerInfosObj.getLayerInfoById(this.dataSource.layerId);
a&&(this._layerFilter=a.getFilter())}},_onFetch:function(){this.emit("fetching")},_onFetchSuccess:function(){this.emit("success")},_onFetchField:function(a){this.emit("faild",a)},_onDataUpdate:function(a,b){a=this._getValueByFeatures(a,b);this.emit("data-update",a)},_getValueByFeatures:function(a,b){if(!a||!a.length)return null;var c=null;"number"===this.dijit.type||"gauge"===this.dijit.type?c=this._getValueForNumber(a):"chart"===this.dijit.type&&(c={features:a,hasStatisticsed:!!b});return c},_getValueForNumber:function(a){return this._isNeededCalculateForClient()?
b.getSingleValueFromFeatures(this.config.statistic,this.dataSource,a):this._getValueByServerStatFeature(a)},_getValueByServerStatFeature:function(a){if(!a||!a.length)return null;a=a[0].attributes;if(!a)return null;var b=Object.keys(a)[0];if("undefined"===typeof b)return null;a=a[b];return a=Number(a)},_isMapLayer:function(){return"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===this.dataSource.dataSourceType},_isLayerOnDemandMode:function(){return this.layerObject&&this.layerObject.currentMode===r.MODE_ONDEMAND},
_shouldAccessFeaturesBySelection:function(){return this.useSelection&&this.layerObject&&this.layerObject.getSelectedFeatures().length},_shouldAccessClientFeatures:function(){var a=this.config&&"feature"===this.config.mode,b=this.isDateType,c=this._isSupportServerStatByExtent();return a||b||!c},_isSupportServerStatByExtent:function(){var a=this.layerObject&&this.layerObject.version&&10.11<=Number(this.layerObject.version),b=this._isLayerSupportStatistics();return a&&b},_isLayerSupportStatistics:function(){if(this.layerObject){var a=
!1;return a=this.layerObject.advancedQueryCapabilities?!!this.layerObject.advancedQueryCapabilities.supportsStatistics:!!this.layerObject.supportsStatistics}},_getLayerRefreshInterval:function(){if(this.layerObject&&this.layerObject.refreshInterval)return this.layerObject.refreshInterval},_sortClientFeaturesByObjID:function(a,b){if(0<a.length){var d=c.getObjectIdField(b);d&&(b=a[0])&&b.attributes&&b.attributes.hasOwnProperty(d)&&a.sort(function(a,b){a.attributes||(a.attributes={});b.attributes||(b.attributes=
{});a=a.attributes[d];b=b.attributes[d];return a<b?-1:a>b?1:0})}return a},_filterFeaturesByExtent:function(a,b){var c=a.normalize();return b=b.filter(f.hitch(this,function(a){try{if(a.geometry){var b="point"===a.geometry.type||"multipoint"===a.geometry;return c.some(f.hitch(this,function(c){return b?c.contains(a.geometry):e.intersects(c,a.geometry)}))}}catch(x){console.error(x)}return!1}))},_calculateAverageWithNullValueAsZero:function(a){if(!this._shouldCalcAvgForNullValue()||!a||!a.length)return a;
var b=this.config.valueFields;if(!b||!b.length)return a;var d=b.map(function(a){return a+"_sum"});a.forEach(function(a){var b=a.attributes;if(b){var e=b.STAT_COUNT;"undefined"===typeof e?(e=b.stat_count,delete b.stat_count):delete b.STAT_COUNT;var f,g,h;d.forEach(function(a){h=a.replace(/_SUM$/gi,"");var d=c.upperCaseString(a);a=c.lowerCaseString(a);var k=c.upperCaseString(h+"_AVG");f=b[d];"undefined"===typeof f?(f=b[a],delete b[a]):delete b[d];!f&&"number"!==typeof f||!e?b[k]=null:(g=f/e,b[k]=g)})}});
return a},_shouldCalcAvgForNullValue:function(){var a=this.config&&this.config.mode;return a&&("category"===a||"field"===a)&&this.config.nullValue&&"average"===this.config.operation},_shouldLaunchQuery:function(){var a=!0,b=!(!this.queryDeferred||this.queryDeferred.isResolved()||this.queryDeferred.isRejected()),d=c.isEqual(this._queryParameter,this._oldQueryParameter);b&&d&&(a=!1);this._oldQueryParameter=f.clone(this._queryParameter);return a},_getOutStatistics:function(a,b,d){var e=d;"average"===
e&&(e="avg");var f=this.config.nullValue;f&&"avg"===e&&(e="sum");var g=null;"category"===a||"field"===a?b&&b.length&&(g=b.map(function(a){var b=c.upperCaseString(a+"_"+e),d=new t;d.statisticType=e;d.onStatisticField=a;d.outStatisticFieldName=b;return d}.bind(this)),a=null,f&&"average"===d&&(a=new t,a.statisticType="count",a.onStatisticField="*",a.outStatisticFieldName="STAT_COUNT",g.push(a))):"count"===a&&(d=new t,d.statisticType="count",d.onStatisticField=this._getCountTypeOnStatisticsField(),d.outStatisticFieldName=
"STAT_COUNT",g=[d]);return g},_tryGenerateQueryParameter:function(){this._queryParameter={};this._layerUrl&&(this._queryParameter.url=this._layerUrl);this._layerFilter&&(this._queryParameter.where=this._layerFilter);if(this.dijit){var a;if("number"===this.dijit.type||"gauge"===this.dijit.type){if(this.config&&this.config.statistic){var b=this.config.statistic;a=b.statisticsType;var d=b.fieldName,e=c.upperCaseString(d+"_"+a);"Features"===b.type&&(d=this._getCountTypeOnStatisticsField(),a="count",e=
"STAT_COUNT");"average"===a&&(a="avg");b=new t;b.statisticType=a;b.onStatisticField=d;b.outStatisticFieldName=e;this._queryParameter.outStatistics=[b]}}else"chart"===this.dijit.type&&this.config&&(this.statisticsByServer=!0,a=this.config.mode,this._queryParameter.outStatistics=this._getOutStatistics(a,this.config.valueFields,this.config.operation),d=this.config.categoryField,"category"===a||"count"===a)&&(this._queryParameter.groupByFieldsForStatistics=[d])}},_getCountTypeOnStatisticsField:function(){var a=
null;this.layerObject&&(a=(a=(a=this.layerObject.fields)&&a.filter(function(a){return a.type===this.oidFieldType}.bind(this))[0])&&a.name);return a||"*"},_doQuery:function(){var a=new d;if(!this._queryParameter)return a.reject("Empty query parameter."),a;if(!this._queryParameter.url)return a.reject("Empty layer url."),a;var b=new p(this._queryParameter.url),c=new k;c.where=this._queryParameter.where||"1\x3d1";c.returnGeometry=!1;this.dataSource.filterByExtent&&this.map&&(c.geometry=this.map.extent);
this._queryParameter.groupByFieldsForStatistics&&(c.groupByFieldsForStatistics=this._queryParameter.groupByFieldsForStatistics);if(this._hasVaildOutStatistics(this._queryParameter.outStatistics))c.outStatistics=this._queryParameter.outStatistics;else return a.reject("Invaild outStatistics of query params."),a;this._queryParameter.orderByFields&&(c.orderByFields=this._queryParameter.orderByFields);return b.execute(c)},_hasVaildOutStatistics:function(a){return a&&a.length?a.every(function(a){return this._isTrueOrZero(a.onStatisticField)&&
this._isTrueOrZero(a.outStatisticFieldName)&&!!a.statisticType}.bind(this)):!1},_isTrueOrZero:function(a){return!!a||0===a},_tryGetLayerObject:function(){var a=new d;if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"!==this.dataSource.dataSourceType)return a.resolve(),a;var b=this.layerInfosObj.getLayerInfoById(this.dataSource.layerId);if(b){this.layerInfo=b;if(this.layerObject)return this._layerUrl=this.layerObject.url,a.resolve(),a;this._onFetch();return b.getLayerObject().then(f.hitch(this,function(a){this.layerObject=
a;this._layerUrl=this.layerObject.url}))}a.reject("invaild data source");return a},_isExtralStatDataSource:function(){var a=this.dataSource&&this.dataSource.frameWorkDsId;a||(this._isExtralStatDS=!1);var b=this.appConfig.dataSource&&this.appConfig.dataSource.dataSources,a=b&&b[a];this._isExtralStatDS=!(!a||"FeatureStatistics"!==a.type)},_isNeededCalculateForClient:function(){var a=this.layerObject&&this.useSelection&&0<this.layerObject.getSelectedFeatures().length,b="DATA_SOURCE_FROM_FRAMEWORK"===
this.dataSource.dataSourceType,c=this._isSupportServerStatByExtent();return a||b||!c},_resetExtentChangeHandle:function(){this.exchetChangeHandle&&this.exchetChangeHandle.remove&&(this.exchetChangeHandle.remove(),this.exchetChangeHandle=null)},_resetUpdateEndHandle:function(){this.updateEndHandle&&this.updateEndHandle.remove&&(this.updateEndHandle.remove(),this.updateEndHandle=null)},_resetFilterChangedHandle:function(){this.filterChangedHandle&&this.filterChangedHandle.remove&&(this.filterChangedHandle.remove(),
this.filterChangedHandle=null)},_resetSelectionHandle:function(){this.selectionHandle&&this.selectionHandle.remove&&(this.selectionHandle.remove(),this.selectionHandle=null)},_resetRefreshIntervalHandle:function(){this.refreshIntervalHandle&&this.refreshIntervalHandle.remove&&(this.refreshIntervalHandle.remove(),this.refreshIntervalHandle=null)},_resetTimeIntervalHandle:function(){this.timeIntervalHandle&&(clearInterval(this.timeIntervalHandle),this.timeIntervalHandle=null)},_resetExdsBeginUpdateHandle:function(){this.exdsBeginUpdateHandle&&
this.exdsBeginUpdateHandle.remove&&(this.exdsBeginUpdateHandle.remove(),this.exdsBeginUpdateHandle=null)},_removeHandles:function(){this._resetExtentChangeHandle();this._resetUpdateEndHandle();this._resetFilterChangedHandle();this._resetSelectionHandle();this._resetRefreshIntervalHandle();this._resetTimeIntervalHandle();this._resetSelectionHandle()}})})},"widgets/Infographic/_ChartSetting":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./_ChartSetting.html"],
function(n,f,h,l,d){return n([h,l],{templateString:d,baseClass:"ig-chart-setting-dlg",postCreate:function(){var a=this.chartJson.config,b=a.type;"pie"===b?(f.setStyle(this.verticalAxisSection,"display","none"),f.setStyle(this.horizontalAxisSection,"display","none"),f.setStyle(this.withoutRecordsSection,"display","none")):f.setStyle(this.dataLabelsSection,"display","none");this.chartJson.config.dateConfig||f.setStyle(this.withoutRecordsSection,"display","none");this._calcuteLegendDisplay(a)||f.setStyle(this.legendSection,
"display","none");"count"!==this.chartJson.config.mode&&"field"!==this.chartJson.config.mode||"pie"===b||f.setStyle(this.legendSection,"display","none");(a=this.chartJson.config.legend)&&a.show&&this._toggle(this.legendToggle);(a=this.chartJson.config.dataLabel)&&a.show&&this._toggle(this.dataLabelsToggle);(a=this.chartJson.config.xAxis)&&a.show&&this._toggle(this.horizontalAxisToggle);(a=this.chartJson.config.yAxis)&&a.show&&this._toggle(this.verticalAxisToggle);this.chartJson.config.dateConfig&&
this.chartJson.config.dateConfig.isNeedFilled&&this._toggle(this.withoutRecordsToggle)},_calcuteLegendDisplay:function(a){var b=a.mode,c;"pie"===a.type?c=!0:(c=!0,"count"===b||"field"===b?c=!1:a.seriesStyle&&(c="layerSymbol"!==a.seriesStyle.type));return c},_toggle:function(a){f.hasClass(a,"toggle-on")?(f.removeClass(a,"toggle-on"),f.addClass(a,"toggle-off")):(f.removeClass(a,"toggle-off"),f.addClass(a,"toggle-on"))},_onToggleClick:function(a){var b=a.target;this._toggle(b);a=f.hasClass(b,"toggle-on")?
!0:!1;b=f.attr(b,"data-id");"legend"===b?this.chartJson.config.legend.show=a:"dataLabels"===b?this.chartJson.config.dataLabel.show=a:"horizontalAxis"===b?this.chartJson.config.xAxis.show=a:"verticalAxis"===b?this.chartJson.config.yAxis.show=a:"withoutRecords"===b&&this.chartJson.config.dateConfig&&(this.chartJson.config.dateConfig.isNeedFilled=a);this.chartDijit.setConfig(this.chartJson.config);this.chartDijit.startRendering()}})})},"widgets/Infographic/IGUtils":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/promise/all esri/tasks/query esri/tasks/QueryTask jimu/LayerInfos/LayerInfos jimu/DataSourceManager jimu/utils ./utils".split(" "),
function(n,f,h,l,d,a,b,c,m,g){return n([],{constructor:function(a){this.appConfig=a.appConfig;this.map=a.map;this.layerInfosObj=b.getInstanceSync();this.dataSourceManager=c.getInstance()},preprocessingDataSource:function(a){var b=this._tryGetLayerIdDataSchema(a),c=b.dataSchema,b=this._tryGetLayerObject(b.layerId),c=this._tryGetLayerForFrameWork(c),d=this.getLayerDefinitionByDataSource(a);a=this.getFeaturesByDataSource(a);return l([b,c,d,a]).then(function(a){var b=a[0];return{layerObject:b&&b.layerObject,
popupInfo:b&&b.popupInfo,featureLayerForFrameWork:a[1],definition:a[2],features:a[3]}})},_tryGetLayerIdDataSchema:function(a){var b={layerId:"",dataSchema:null};if(a.layerId)this.dsType="CLIENT_FEATURES",b.layerId=a.layerId;else if(a.frameWorkDsId){a=(a=g.getDsTypeInfoMeta(a.frameWorkDsId,this.appConfig))&&a.dsMeta;if(!a)return b;"Features"===a.type?this.dsType="FRAMEWORK_FEATURES":"FeatureStatistics"===a.type&&(this.dsType="FRAMEWORK_STATISTICS");b.dataSchema=a.dataSchema;a=g.parseDataSourceId(a.id);
b.layerId=a&&a.layerId}return b},_tryGetLayerObject:function(a){var b=new f;if(!a)return b.resolve(),b;var c=this.layerInfosObj.getLayerInfoById(a);c||(c=this.layerInfosObj.getTableInfoById(a));if(!c)return console.error("Invaild data source"),b.resolve(),b;var d=c.getPopupInfo();return c.getLayerObject().then(function(a){return{layerObject:a,popupInfo:d}}.bind(this))},_tryGetLayerForFrameWork:function(a){var b=new f;if(!a)return b.resolve(),b;b=a;"FRAMEWORK_STATISTICS"===this.dsType&&(b=g.mockLayerDefinitionForSTD(a));
return g.getLoadedLayer(b).then(function(a){return a}.bind(this))},getLayerDefinitionByDataSource:function(a){var b=new f;if(!a)return b.reject("Invaild data source"),b;if(a.layerId){var c=this.layerInfosObj.getLayerInfoById(a.layerId),d=c.getPopupInfo();c&&this._getServiceDefinitionByLayerInfo(c).then(function(a){this._addAliasForLayerDefinition(a,d);b.resolve(a)}.bind(this))}else a.frameWorkDsId&&(c=null,a=(this.appConfig.dataSource&&this.appConfig.dataSource.dataSources)[a.frameWorkDsId],"Features"===
a.type?(c=h.clone(a.dataSchema),this._addAliasForLayerDefinition(c),b.resolve(c)):"FeatureStatistics"===a.type&&(c={type:"Table",fields:[]},a=h.clone(a.dataSchema),c.fields=a.fields,a.groupByFields&&a.groupByFields[0]&&(c.groupByFields=h.clone(a.groupByFields)),this._addAliasForLayerDefinition(c),b.resolve(c)));return b},_getServiceDefinitionByLayerInfo:function(a){return a.getServiceDefinition().then(h.hitch(this,function(b){return b?b:a.getLayerObject().then(h.hitch(this,function(a){return a?m.getFeatureLayerDefinition(a):
null}))}))},_addAliasForLayerDefinition:function(a,b){a&&a.fields&&0<a.fields.length&&a.fields.forEach(h.hitch(this,function(a){var c=g.getFieldAliasByFieldInfo(a,b);c&&(a.alias=c)}))},getFeaturesByDataSource:function(a){return this._getFeaturesByDataSource(a).then(function(a){(a=a&&a.features)||(a=[]);a&&1E3<a.length&&(a=a.slice(0,1E3));return a}.bind(this),function(a){return a}.bind(this))},_getFeaturesByDataSource:function(b){var c=new f;if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===b.dataSourceType){var e=
this.layerInfosObj.getLayerInfoById(b.layerId);if(!e)return c.reject("Can not get layerInfo by the layer id of this data source."),c;b=e.getUrl();e=e.getFilter();if(!b)return c.reject("Invaild layer url of data source."),c;c=new d;c.outSpatialReference=this.map.spatialReference;c.where=e||"1\x3d1";c.outFields=["*"];c.returnGeometry=!1;return(new a(b)).execute(c)}if("DATA_SOURCE_FROM_FRAMEWORK"===b.dataSourceType){b=this.dataSourceManager.getDataSourceConfig(b.frameWorkDsId);if(!b)return c.reject("Can not get vaild data source config by the frameWorkDsId of this data source."),
c;b.filterByExtent=!1;return this.dataSourceManager.doQuery(b)}}})})},"widgets/Infographic/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Infographic/dijits/ChartDijit.html":'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\r\n    \x3cdiv style\x3d"display: none;" data-dojo-attach-point\x3d"yAxisName" class\x3d"y-axis-name rotate"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"chart-dijit" style\x3d"width:100%;height:100%;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"noDataDiv" class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\r\n        \x3cdiv class\x3d"chart-dom" data-dojo-attach-point\x3d"chartDomNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Infographic/_ChartSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"legendSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.legend}"\x3e${nls.legend}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"legendToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"legend"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"dataLabelsSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.dataLabels}"\x3e${nls.dataLabels}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dataLabelsToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"dataLabels"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"horizontalAxisSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.horizontalAxis}"\x3e${nls.horizontalAxis}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"horizontalAxisToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"horizontalAxis"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"verticalAxisSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.verticalAxis}"\x3e${nls.verticalAxis}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"verticalAxisToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"verticalAxis"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n   \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"withoutRecordsSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.showPeriodsWithoutRecords}"\x3e${nls.showPeriodsWithoutRecords}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"withoutRecordsToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"withoutRecords"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/Infographic/Widget.html":'\x3cdiv style\x3d"width: 100%;height: 100%;"\x3e\r\n\t \x3cdiv data-dojo-attach-point\x3d"shelter" class\x3d"loading hide"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Infographic/css/style.css":'@font-face {font-family: \'icomoon\'; src: url("fonts/icomoon.eot?oflavm"); src: url("fonts/icomoon.eot?oflavm#iefix") format(\'embedded-opentype\'), url("fonts/icomoon.ttf?oflavm") format(\'truetype\'), url("fonts/icomoon.woff?oflavm") format(\'woff\'), url("fonts/icomoon.svg?oflavm#icomoon") format(\'svg\'); font-weight: normal; font-style: normal;}.jimu-widget-infographic .indicator-icon,.jimu-widget-infographic-setting .indicator-icon {font-family: \'icomoon\' !important; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.jimu-widget-infographic .loading {position: absolute; overflow: hidden; bottom: 4px; right: 0; width: 17px; height: 17px; z-index: 101;}.jimu-rtl .jimu-widget-infographic .loading {left: 2px; right: auto;}.jimu-widget-infographic .loading {font-size: 10px; text-indent: -9999em; border-top: 3px solid rgba(219, 206, 206, 0.7); border-right: 3px solid rgba(219, 206, 206, 0.7); border-bottom: 3px solid rgba(219, 206, 206, 0.7); border-left: 3px solid #ffffff; -webkit-transform: translateZ(0); -ms-transform: translateZ(0); transform: translateZ(0); -webkit-animation: load8 1.1s infinite linear; animation: load8 1.1s infinite linear; box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.2); border-radius: 8px;}.jimu-widget-infographic .loading:after {border-radius: 50%; width: 24px; height: 24px;}.jimu-widget-infographic .hide {display: none !important;}.icon-like:before {content: "\\e900";}.icon-unlike:before {content: "\\e904";}.icon-stop:before {content: "\\e902";}.icon-danger:before {content: "\\e901";}.icon-star:before {content: "\\e903";}.icon-alarm:before {content: "\\e906";}.icon-down:before {content: "\\e909";}.icon-right:before {content: "\\e90f";}.icon-up:before {content: "\\e911";}.icon-wrong:before {content: "\\e912";}.lm_goldenlayout .lm_item .lm_content {position: relative;}.lm_goldenlayout .lm_item .lm_content .table-layout-container {display: table; table-layout: fixed; overflow: hidden; width: 100%; height: 100%;}.lm_goldenlayout .lm_item .lm_content .table-layout-container \x3e div {padding: 10px 15px;}.lm_goldenlayout .lm_item .lm_content .image-node {display: table-cell; overflow: hidden; position: relative; width: 100%; height: 100%;}.lm_goldenlayout .lm_item .lm_content .no-trim {white-space: pre-wrap;}.infographic-number-dijit {display: flex; justify-content: center; align-items: center;}.infographic-number-dijit .number-content .value-content {white-space: nowrap;}.infographic-number-dijit a,.infographic-number-dijit a:hover,.infographic-number-dijit a:visited,.infographic-number-dijit a:link,.infographic-number-dijit a:active {text-decoration: none;}.infographic-number-dijit.horizontal-left {justify-content: flex-start;}.infographic-number-dijit.horizontal-center {justify-content: center;}.infographic-number-dijit.horizontal-right {justify-content: flex-end;}.infographic-number-dijit.vertical-top {align-items: flex-start;}.infographic-number-dijit.vertical-middle {align-items: center;}.infographic-number-dijit.vertical-bottom {align-items: flex-end;}.infographic-number-dijit .number-content {display: flex; justify-content: center; max-width: 340px;}.infographic-number-dijit .number {display: flex; justify-content: space-between; align-items: baseline;}.infographic-number-dijit .indicator-icon {font-size: 22px; align-self: center; text-align: center;}.infographic-number-dijit .number .prefix {margin-right: 6px;}.infographic-number-dijit .number .suffix {margin-left: 6px;}.infographic-number-dijit .rightImgDiv {width: 35%; height: 100%; text-align: left;}.jimu-widget-infographic .infographic-number-dijit,.jimu-widget-infographic .infographic-chart-dijit,.jimu-widget-infographic .infographic-gauge-dijit {position: relative;}.infographic-number-dijit .no-data-tip,.infographic-chart-dijit .no-data-tip,.infographic-gauge-dijit .no-data-tip {display: none; position: absolute; left: 0; right: 0; height: 30px; top: calc(50% - 10px); text-align: center; color: #666;}.infographic-number-dijit.no-data .no-data-tip,.infographic-chart-dijit.no-data .no-data-tip,.infographic-gauge-dijit.no-data .no-data-tip {display: block; margin: 0 10px;}.infographic-number-dijit.no-data .chart-dom,.infographic-chart-dijit.no-data .chart-dom,.infographic-gauge-dijit.no-data .gauge-dom {visibility: hidden;}.infographic-number-dijit .chart-dom,.infographic-chart-dijit .chart-dom,.infographic-gauge-dijit .gauge-dom {visibility: visible; width: 100%; height: 100%;}.infographic-chart-dijit {display: flex;}.infographic-chart-dijit .y-axis-name {width: 30px; height: 100%; flex: 0 1 auto; justify-content: center; align-items: center; display: flex; white-space: nowrap; font-family: sans-serif; font-size: 12px;}.infographic-chart-dijit .y-axis-name.rotate {transform: rotate(-90deg); -webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg); -ms-transform: rotate(-90deg); -o-transform: rotate(-90deg); filter: progid:DXImageTransform.Microsoft.BasicImage(rotation\x3d3);}.infographic-chart-dijit .chart-dijit {width: calc(100% - 30px); height: 100%; flex: 1 1 auto;}.jimu-widget-infographic {position: relative; width: 100%; height: 100%;}.jimu-widget-infographic .chart-setting {position: absolute; top: 0; right: 0; cursor: pointer; width: 16px; height: 16px; background: no-repeat center center url(images/chart-setting.svg); z-index: 1;}.jimu-rtl .jimu-widget-infographic .chart-setting {left: 0; right: auto;}.ig-chart-setting-dlg .jimu-leading-margin10 {margin-left: 10px; margin-right: 0;}.jimu-rtl .ig-chart-setting-dlg .jimu-leading-margin10 {margin-right: 10px; margin-left: 0;}.ig-chart-setting-dlg .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.ig-chart-setting-dlg .flex {display: flex; justify-content: space-between; margin-top: 8px;}.ig-chart-setting-dlg .label {width: 120px;}.ig-chart-setting-dlg .toggle {width: 38px; height: 18px; cursor: pointer;}.ig-chart-setting-dlg .toggle.toggle-on {background: no-repeat center left url(./images/toggle_on_light.svg);}.ig-chart-setting-dlg .toggle.toggle-off {background: no-repeat center left url(./images/toggle_off_light.svg);}',
"*now":function(n){n(['dojo/i18n!*preload*widgets/Infographic/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetsInTemplateMixin dijit/popup dijit/TooltipDialog jimu/BaseWidget jimu/dijit/GridLayout jimu/LayerInfos/LayerInfos jimu/utils ./DijitFactory ./dijits/SourceLauncher ./_ChartSetting ./IGUtils ./utils".split(" "),function(n,f,h,l,d,a,b,c,m,g,e,k,p,t,r,q,w,v){return n([g,b],{name:"Infographic",baseClass:"jimu-widget-infographic",dijits:null,clientFeaturesHandle:null,layerInfosObj:null,dataSource:null,
mainDijit:null,mainDijitJson:null,mainDijitVisible:!1,postCreate:function(){this.inherited(arguments);this.dijits=[];this.layerInfosObj=k.getInstanceSync();this._initDijitFactory();this.igUtils=new w({appConfig:this.appConfig,map:this.map});this.on("click",f.hitch(this,function(){this.chartSettingDialog&&c.close(this.chartSettingDialog)}));this._features=[];this.featureLayerForFrameWork=this.popupInfo=this.layerObject=null;this.mainDijitVisible=(this.mainDijitJson=this._getMainDijitJson())&&this.mainDijitJson.visible},
startup:function(){this.inherited(arguments);this._createUI();this._createChartSettingBtn();this._setDataSource();this.mainDijitVisible&&this.dsAvailable&&(this._proDataSourceDef=this._preprocessingDataSource())},_setDataSource:function(){var a=this.config&&this.config.dataSource,b=this._checkDataSource(a);this.dsAvailable=!b.code;!this.dsAvailable&&this.mainDijit&&this.mainDijit.showNodata(b.message);this.dsAvailable&&this.dijits&&this.dijits.length&&this.dijits.forEach(function(b){b.setDataSource(a)})},
onOpen:function(){this._proDataSourceDef?(this._showLoading(),this._proDataSourceDef.then(function(){this._hideLoading();this._proDataSourceDef=null;this._initMainDijit();this._onOpenTriger()}.bind(this),function(a){this._hideLoading();this._proDataSourceDef=null;console.error(a)}.bind(this))):this._onOpenTriger()},resize:function(){this.inherited(arguments);this.layout&&this.layout.resize();this.mainDijit&&this.mainDijit.resize&&this.mainDijit.resize()},onClose:function(){this.sourceLauncher&&this.sourceLauncher.sleep();
this.chartSettingDialog&&this.chartSettingDialog.isShow&&(c.close(this.chartSettingDialog),this.chartSettingDialog.isShow=!1)},onDataSourceDataUpdate:function(a,b){this.config.dataSource&&a===this.config.dataSource.frameWorkDsId&&this.sourceLauncher&&this.sourceLauncher.setAppConfigDSFeatures(b.features)},destroy:function(){this.sourceLauncher&&this.sourceLauncher.destroy();this.chartSettingDialog&&(this.chartSettingDialog.destroy(),this.chartSettingDialog=null);this.inherited(arguments)},_createUI:function(){if(this.config.layout){h.forEach(this.dijits,
f.hitch(this,function(a){a.destroy()}));this.dijits=[];var a=h.map(this.config.dijits,function(a){var b=t.createDijit(a);this.dijits.push(b);return{id:a.id,dijit:b}},this);this.layout=new e({components:a,layoutDefinition:this.config.layout.definition,container:this.domNode,editable:!1});this.layout.on("initialised",f.hitch(this,function(){h.forEach(this.dijits,f.hitch(this,function(a){a.startup()}))}));this.mainDijit=this._getMainDijit()}},_checkDataSource:function(a){var b=v.checkDataSourceIsVaild(a,
this.mainDijitJson,this.map,this.appConfig);a=this._getDSErrorString(b,a);return{code:b.code,message:a}},_getDSErrorString:function(a,b){var c="";b=b&&b.name;1===a.code&&(c=this.nls.dataSource+" "+b+" "+this.nls.dsErrorTipSuf);2===a.code&&(c=this.nls.fieldString+" "+a.fields.join(",")+" "+this.nls.dsErrorTipSuf);return c},_onOpenTriger:function(){this.mainDijitVisible&&this.dsAvailable&&this._isDOMInitialized().then(function(){clearInterval(this.domReadyInterval);this.config.dataSource&&(this.sourceLauncher?
this.sourceLauncher.awake():(this._initSourceLauncher(),this.sourceLauncher.start()),this.resize())}.bind(this))},_onClientFeaturesUpdate:function(a){this._shouldUpdateData(a)&&(this._oldValue=a,this._onDataUpdate(a))},_onDataUpdate:function(a){this.mainDijit&&(this.mainDijit.onDataSourceDataUpdate(a),this.mainDijit.startRendering())},_HandlingOutliers:function(a){if(null===a||"undefined"===typeof a&&this.mainDijit)return this.mainDijit.showNodata(),!0},_showLoading:function(){l.removeClass(this.shelter,
"hide")},_hideLoading:function(){l.addClass(this.shelter,"hide")},_getMainDijit:function(){if(this.dijits&&this.dijits.length){var a=null,b=["number","gauge","chart"];return a=this.dijits.filter(function(a){return-1<b.indexOf(a.type)})[0]}},_getMainDijitJson:function(){if(this.config&&this.config.dijits&&this.config.dijits.length){var a=null,b=["number","gauge","chart"];return a=this.config.dijits.filter(function(a){return-1<b.indexOf(a.type)})[0]}},_initMainDijit:function(){this.mainDijit&&this.mainDijit.setLayerInfo(this.layerObject,
this.featureLayerForFrameWork,this.popupInfo)},_createChartSettingBtn:function(){this.mainDijitVisible&&this.config.dijits&&h.some(this.config.dijits,function(a){return a.visible&&"chart"===a.type},this)&&(this.chartSettingNode=l.create("div",{"class":"chart-setting"},this.domNode),this.own(d(this.chartSettingNode,"click",f.hitch(this,this._onChartSettingClick))),this.chartSettingDialog=new m({content:this._createChartSettingContent()}),this.chartSettingDialog.isShow=!1)},_onChartSettingClick:function(a){this.chartSettingDialog.isShow?
(c.close(this.chartSettingDialog),this.chartSettingDialog.isShow=!1):(c.open({popup:this.chartSettingDialog,around:this.chartSettingNode}),this.chartSettingDialog.isShow=!0);a.stopPropagation()},_createChartSettingContent:function(){var a=h.filter(this.config.dijits,function(a){return"chart"===a.type})[0];return a?a.config?(new q({chartJson:a,chartDijit:h.filter(this.dijits,function(b){return b.jsonId===a.id})[0],nls:this.nls})).domNode:"\x3cdiv\x3e\x3c/div\x3e":(console.error("Unknow error"),"\x3cdiv\x3e\x3c/div\x3e")},
_isDOMInitialized:function(){var b=new a;setTimeout(function(){this.domReadyInterval=setInterval(function(){var a=this.mainDijit&&this.mainDijit.domNode;a&&(a=l.getMarginBox(a),a.w&&a.h&&b.resolve())}.bind(this),200)}.bind(this),200);return b},_initSourceLauncher:function(){if(this.config.dataSource){var a=this._getMainDijitJson();a&&(this.sourceLauncher=new r({layerObject:this.layerObject,map:this.map,appConfig:this.appConfig,useSelection:this.config.dataSource.useSelection,filterByExtent:this.config.dataSource.filterByExtent,
dataSource:this.config.dataSource,dijit:a}),this._listenSourceLauncherEvent())}},_listenSourceLauncherEvent:function(){this.own(d(this.sourceLauncher,"data-update",f.hitch(this,function(a){this._onClientFeaturesUpdate(a)})));this.own(d(this.sourceLauncher,"fetching",f.hitch(this,function(){this._showLoading()})));this.own(d(this.sourceLauncher,"success",f.hitch(this,function(){this._hideLoading()})));this.own(d(this.sourceLauncher,"faild",f.hitch(this,function(a){console.error(a.message||a);this._HandlingOutliers();
this._hideLoading()})))},_shouldUpdateData:function(a){if(this._HandlingOutliers(a))return!1;var b=!0;if("number"===typeof a)a===this._oldValue&&(b=!1);else if(a&&a.features&&this._oldValue&&this._oldValue.features){var c=h.map(this._oldValue.features,function(a){return a.attributes});a=h.map(a.features,function(a){return a.attributes});p.isEqual(c,a)&&(b=!1)}return b},_initDijitFactory:function(){t.setNls(this.nls);t.setMap(this.map);t.setInSettingPage(!1);t.setAppConfig(this.appConfig);t.setContext({folderUrl:this.folderUrl})},
_preprocessingDataSource:function(){var b=this.config&&this.config.dataSource,c=new a;return b?this.igUtils.preprocessingDataSource(b).then(function(a){this.layerObject=a&&a.layerObject;this.popupInfo=a&&a.popupInfo;this.featureLayerForFrameWork=a&&a.featureLayerForFrameWork}.bind(this)):(c.reject("Empty data source"),c)}})});